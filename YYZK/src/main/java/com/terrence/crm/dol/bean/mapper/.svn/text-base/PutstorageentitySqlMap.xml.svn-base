<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Putstorageentity">

        
	<resultMap id="RM.Putstorageentity" class="com.terrence.crm.dol.bean.Putstorageentity">
        <result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
        <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
        <result property="fsourcewin" column="fsourcewin"/>
        
        <result property="oldentityid" column="oldentityid"/>
        <result property="fcommitqy" column="fcommitqy"/>
        <result property="tovoid" column="tovoid"/>
        
         <result property="waitid" column="waitid"/>
    </resultMap>
    
    
    
    <resultMap id="RM.Putstorageentity.putstorageentity.list" class="com.terrence.crm.dol.bean.Putstorageentity"><!-- 入库单列表 -->
        <result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
         <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
        <result property="zdname" column="zdname"/>
        <result property="shname" column="shname"/>
        <result property="stname" column="stname"/>
        <result property="admin" resultMap="RM.Admin.in.putstorageentity"/>
        <result property="supp" resultMap="RM.Supplier.in.putstorageentity"/>
        <result property="stock" resultMap="RM.Stock.in.putstorageentity"/>
        <result property="putstorage" resultMap="RM.Putstorage.in.putstorageentity.list"/>
        <result property="icitem" resultMap="RM.Icitem.in.putstorageentity"/>
        
        <result property="fsourcewin" column="fsourcewin"/>
        <result property="oldentityid" column="oldentityid"/>
        <result property="fcommitqy" column="fcommitqy"/>
        <result property="tovoid" column="tovoid"/>
        
        <result property="waitid" column="waitid"/>
    </resultMap>
	 <resultMap id="RM.Admin.in.putstorageentity" class="com.terrence.crm.dol.bean.Admin">
        <result property="adminName" column="adminName"/>
    </resultMap>
    <resultMap id="RM.Supplier.in.putstorageentity" class="com.terrence.crm.dol.bean.Supplier">
        <result property="fname" column="fname"/>
    </resultMap>
	  <resultMap id="RM.Stock.in.putstorageentity" class="com.terrence.crm.dol.bean.Stock">
        <result property="fname" column="fname"/>
    </resultMap>
    <resultMap id="RM.Putstorage.in.putstorageentity.list" class="com.terrence.crm.dol.bean.Putstorage">
        <result property="finterid" column="finterid"/>
        <result property="fbillno" column="fbillno"/>
        <result property="creatdate" column="creatdate"/>
        <result property="isclose" column="isclose"/>
        <result property="status" column="status"/>
        <result property="supplier" column="supplier"/>
        <result property="empid" column="empid"/>
        <result property="checker" column="checker"/>
        <result property="maker" column="maker"/>
        <result property="checkdate" column="checkdate"/>
        <result property="srctype" column="srctype"/>
        <result property="isreturn" column="isreturn"/>
        <result property="fstatusDesc" column="fstatusDesc"/>
        
    </resultMap>
     <resultMap id="RM.Icitem.in.putstorageentity" class="com.terrence.crm.dol.bean.Icitems">
       
        <result property="itemname" column="itemname"/>
        <result property="formatno" column="formatno"/>
        <result property="unitname" column="unitname"/>
        <result property="fissnmanager" column="fissnmanager"/>
    </resultMap>
    
    
      <resultMap id="RM.Icitem.in.putstorageentity.update.status" class="com.terrence.crm.dol.bean.Icitems">
       
        <result property="itemname" column="itemname"/>
        <result property="formatno" column="formatno"/>
        <result property="unitname" column="unitname"/>
        <result property="isbatch" column="isbatch"/>
        <result property="fissnmanager" column="fissnmanager"/>
        
        
    </resultMap>


	     
	<resultMap id="RM.Putstorageentity.for.find.putList" class="com.terrence.crm.dol.bean.Putstorageentity">
        <result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
            <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
        <result property="icitemput" resultMap="RM.Icitem.in.putstorageentity.update.status"/>
        
        <result property="fsourcewin" column="fsourcewin"/>
        <result property="oldentityid" column="oldentityid"/>
        <result property="fcommitqy" column="fcommitqy"/>
        <result property="tovoid" column="tovoid"/>
        
        <result property="waitid" column="waitid"/>
        <result property="taskjobno" column="taskjobno"/>
    </resultMap>
    
    
    <resultMap id="RM.Putstorageentity.tongbudata" class="com.terrence.crm.dol.bean.Putstorageentity"><!-- 同步数据查询 -->
        <result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
        <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
         <result property="baseitem" column="itemcode" select="Putstorageentity.find.baseitem.in.Putstorageentity"/>
         <result property="poorderentry" column="orderid" select="Putstorageentity.find.poorderentry.in.tongbu"/>
         
         <result property="fsourcewin" column="fsourcewin"/>
         <result property="oldentityid" column="oldentityid"/>
         <result property="fcommitqy" column="fcommitqy"/>
         <result property="tovoid" column="tovoid"/>
         
         <result property="waitid" column="waitid"/>
    </resultMap>
     <resultMap id="RM.BaseItem.in.Putstorageentity.tongbudata" class="com.terrence.crm.dol.bean.BaseItem">
        <result property="fitemid" column="fitemid"/>
        <result property="unitid" column="unitid"/>
    </resultMap>
    <resultMap id="RM.Poorderentry.putstorageentity.tongbu" class="com.terrence.crm.dol.bean.Poorderentry">
        <result property="orderid" column="orderid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="itemname" column="itemname"/>
        <result property="itemmode" column="itemmode"/>
        <result property="price" column="price"/>
        <result property="fqty" column="fqty"/>
        <result property="unitname" column="unitname"/>
        <result property="mrpclosed" column="mrpclosed"/>
        <result property="itemid" column="itemid"/>
        <result property="sendstatus" column="sendstatus"/>
        <result property="sendtime" column="sendtime"/>
        <result property="createtime" column="createtime"/>
        <result property="buystatus" column="buystatus"/>
        <result property="fcurrencyid" column="fcurrencyid"/>
        <result property="ftaxprice" column="ftaxprice"/>
        <result property="ftaxamount" column="ftaxamount"/>
        <result property="famount" column="famount"/>
        <result property="fdate" column="fdate"/>
        <result property="f101" column="f_101"/>
        <result property="f102" column="f_102"/>
        <result property="empid" column="empid"/>
        <result property="deptid" column="deptid"/>
        <result property="ispush" column="ispush"/>
        <result property="anumber" column="anumber"/>
        <result property="fsourcebillno" column="fsourcebillno"/>
        <result property="issync" column="issync"/>
        <result property="reqcomment" column="reqcomment"/>
        <result property="fcomment" column="fcomment"/>
        <result property="supplierid" column="supplierid"/>
        <result property="fcess" column="fcess"/>
        <result property="bought" column="bought"/>
        <result property="putqty" column="putqty"/>
        <result property="fexchangerate" column="fexchangerate"/>
    </resultMap>
    
    <resultMap id="RM.Putstorageentity.select.add.stockname" class="com.terrence.crm.dol.bean.Putstorageentity"><!-- 同步数据添加仓库名称 -->
        <result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
        <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
        <result property="stname" column="stname"/>
          <result property="baseitem" column="itemcode" select="Putstorageentity.find.baseitem.in.Putstorageentity"/>
         <result property="poorderentry" column="orderid" select="Putstorageentity.find.poorderentry.in.tongbu"/>
         
         <result property="fsourcewin" column="fsourcewin"/>
         <result property="oldentityid" column="oldentityid"/>
         <result property="fcommitqy" column="fcommitqy"/>
         <result property="tovoid" column="tovoid"/>
         
         <result property="waitid" column="waitid"/>
         <result property="taskjobno" column="taskjobno"/>
    </resultMap>
    
    
    
    <resultMap id="RM.Putstorageentity.returnGoods.data.list" class="com.terrence.crm.dol.bean.Putstorageentity"><!-- 入库退货查询 -->
        <result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
         <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
        <result property="zdname" column="zdname"/>
        <result property="shname" column="shname"/>
        <result property="stname" column="stname"/>
        <result property="admin" resultMap="RM.Admin.in.putstorageentity"/>
        <result property="supp" resultMap="RM.Supplier.in.putstorageentity"/>
        <result property="stock" resultMap="RM.Stock.in.putstorageentity"/>
        <result property="putstorage" resultMap="RM.Putstorage.in.putstorageentity.list"/>
        <result property="icitem" resultMap="RM.Icitem.in.putstorageentity"/>
        
        <result property="fsourcewin" column="fsourcewin"/>
        <result property="oldentityid" column="oldentityid"/>
        <result property="fcommitqy" column="fcommitqy"/>
        <result property="tovoid" column="tovoid"/>
        
        <result property="waitid" column="waitid"/>
    </resultMap>
    
    <resultMap id="RM.Putstorageentity.fk.tovoid.data" class="com.terrence.crm.dol.bean.Putstorageentity">
        <result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
        <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
        <result property="fsourcewin" column="fsourcewin"/>
        
        <result property="oldentityid" column="oldentityid"/>
        <result property="fcommitqy" column="fcommitqy"/>
        <result property="tovoid" column="tovoid"/>
        
        <result property="waitid" column="waitid"/>
    </resultMap>
    
    
    <resultMap class="com.terrence.crm.dol.bean.Putstorageentity" id="RM.Putstorageentity.findList.Byfinterid">
    	<result property="entityid" column="entityid"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="itemcode" column="itemcode"/>
    </resultMap>
    

   
    
    <resultMap id="MR.Putstorageentity.excelOut.putData" class="com.terrence.crm.dol.bean.Putstorageentity"><!-- 入库单数据导出查询 -->
        <result property="entityid" column="entityid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="createdate" column="createdate"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fxmark" column="fxmark"/>
        <result property="stname" column="stname"/>
        <result property="teamname" column="teamname"/>
        <result property="suppername" column="suppername"/>
        <result property="poorderentry" resultMap="MR.select.poorderentry.excelData"/>
        <result property="putstorage" resultMap="MR.putstorage.select.Outexcel.data"/>
        <result property="baseitem" resultMap="MR.baseitem.select.date.excelOut"/>
    </resultMap>
    
    <resultMap class="com.terrence.crm.dol.bean.Poorderentry" id="MR.select.poorderentry.excelData">
        <result property="ftaxprice" column="ftaxprice"/>
        <result property="f101" column="f_101"/>
    </resultMap>
    <resultMap class="com.terrence.crm.dol.bean.Putstorage" id="MR.putstorage.select.Outexcel.data">
        <result property="fbillno" column="fbillno"/>
        <result property="creatdate" column="creatdate"/>
        <result property="checkdate" column="checkdate"/>
    </resultMap>
   
    <resultMap id="MR.baseitem.select.date.excelOut" class="com.terrence.crm.dol.bean.BaseItem">
        <result property="itemname" column="itemname"/>
        <result property="formatno" column="formatno"/>
        <result property="unitname" column="unitname"/>
        <result property="f102" column="f_102"/>
    </resultMap>
    
    
     <resultMap id="MR.putstorageentity.and.putstorage.select.data" class="com.terrence.crm.dol.bean.Putstorageentity">
        <result property="entityid" column="entityid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="storageid" column="storageid"/>
        <result property="unitid" column="unitid"/>
        <result property="stname" column="stname"/>
        <result property="fxmark" column="fxmark"/>
        <result property="poorderno" column="poorderno"/>
        <result property="baseitem" resultMap="baseitem.select.data.for.saleOut"/>
        <result property="poorderentry" resultMap="poorderentry.rm.select.for.saleOut"/>
        <result property="putstorage" resultMap="putstorage.data.for.saleOUT.select"/>
    </resultMap>
     <resultMap id="baseitem.select.data.for.saleOut" class="com.terrence.crm.dol.bean.BaseItem">
        <result property="itemname" column="itemname"/>
        <result property="formatno" column="formatno"/>
        <result property="unitname" column="unitname"/>
    </resultMap>
     <resultMap class="com.terrence.crm.dol.bean.Putstorage" id="putstorage.data.for.saleOUT.select">
        <result property="fbillno" column="fbillno"/>
        <result property="checkdate" column="checkdate"/>
        <result property="status" column="status"/>
    </resultMap>
    <resultMap class="com.terrence.crm.dol.bean.Poorderentry" id="poorderentry.rm.select.for.saleOut">
        <result property="ftaxprice" column="ftaxprice"/>
        <result property="price" column="price"/>
        <result property="fcomment" column="fcomment"/>
    </resultMap>
    
    
    
    <resultMap class="com.terrence.crm.dol.bean.Putstorageentity" id="New.RM.Putstorageentity.for.entity.select">
    	<result property="entityid" column="entityid"/>
        <result property="finterid" column="finterid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="storageid" column="storageid"/>
        <result property="createdate" column="createdate"/>
        <result property="unitid" column="unitid"/>
        <result property="fqty" column="fqty"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="poorderno" column="poorderno"/>
        <result property="fsrcinterid" column="fsrcinterid"/>
        <result property="orderid" column="orderid"/>
        <result property="fxmark" column="fxmark"/>
        <result property="fsourcewin" column="fsourcewin"/>
        <result property="oldentityid" column="oldentityid"/>
        <result property="fcommitqy" column="fcommitqy"/>
        <result property="tovoid" column="tovoid"/>
        <result property="waitid" column="waitid"/>
        <result property="stname" column="stname"/>
         <result property="baseitem" resultMap="baseitem.select.data.for.saleOut.NewData"/>
        <result property="poorderentry" resultMap="poorderentry.rm.select.for.saleOut.NewData"/>
        <result property="putstorage" resultMap="putstorage.data.for.saleOUT.select.NewData"/>
    
    </resultMap>
     <resultMap id="baseitem.select.data.for.saleOut.NewData" class="com.terrence.crm.dol.bean.BaseItem">
        <result property="itemname" column="itemname"/>
        <result property="formatno" column="formatno"/>
        <result property="unitname" column="unitname"/>
        <result property="fissnmanager" column="fissnmanager"/>
    </resultMap>
     <resultMap class="com.terrence.crm.dol.bean.Putstorage" id="putstorage.data.for.saleOUT.select.NewData">
        <result property="fbillno" column="fbillno"/>
    </resultMap>
    <resultMap class="com.terrence.crm.dol.bean.Poorderentry" id="poorderentry.rm.select.for.saleOut.NewData">
        <result property="ftaxprice" column="ftaxprice"/>
        <result property="price" column="price"/>
        <result property="fcomment" column="fcomment"/>
    </resultMap>
    
    
    <resultMap class="com.terrence.crm.dol.bean.Putstorageentity" id="Putstorageentity.for.fqty.jijia.icmo">
    	<result property="fqty" column="fqty"/>
    </resultMap>
    
    <resultMap class="com.terrence.crm.dol.bean.Putstorageentity" id="entity.select.sumfqty.data.change.baseitem">
    	<result property="fqty" column="fqty"/>
    </resultMap>
    
    
	<!-- 用于select查询公用抽取的列 -->
	<sql id="Putstorageentity.columns">
	    <![CDATA[
        	t_putstorageentity.entityid ,
        	t_putstorageentity.finterid ,
        	t_putstorageentity.itemcode ,
        	t_putstorageentity.storageid ,
        	t_putstorageentity.createdate ,
        	t_putstorageentity.unitid ,
        	t_putstorageentity.fqty ,
        	t_putstorageentity.fbatchno ,
        	t_putstorageentity.poorderno ,
        	t_putstorageentity.fsrcinterid ,
        	t_putstorageentity.orderid,
        	t_putstorageentity.fxmark,
        	t_putstorageentity.fsourcewin,
        	t_putstorageentity.oldentityid,
        	t_putstorageentity.fcommitqy,
        	t_putstorageentity.tovoid,
        	t_putstorageentity.waitid
	    ]]>
	</sql>
	
   <insert id="Putstorageentity.insert" >
    <![CDATA[
        INSERT INTO
        t_putstorageentity (
        	entityid ,
        	finterid ,
        	itemcode ,
        	storageid ,
        	createdate ,
        	unitid ,
        	fqty ,
        	fbatchno ,
        	poorderno ,
        	fsrcinterid ,
        	orderid,
        	fsourcewin,
        	oldentityid,
        	fcommitqy,
        	makecodeNumber,
        	tovoid
        ) VALUES (
        	#entityid# ,
        	#finterid# ,
        	#itemcode# ,
        	#storageid# ,
        	#createdate# ,
        	#unitid# ,
        	#fqty# ,
        	#fbatchno# ,
        	#poorderno# ,
        	#fsrcinterid# ,
        	#orderid#,
        	#fsourcewin#,
        	#oldentityid#,
        	#fcommitqy#,
        	#makecodeNumber#,
        	#tovoid#
        )
    ]]> 
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="entityid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>
    
     
    
    <insert id="Putstorageentity.insert.in.poorderentry" ><!-- 免检保存入库明细 -->
   
        INSERT INTO
        t_putstorageentity (
        	
	        	finterid ,
	        
	        	itemcode
	        <isNotEmpty prepend="," property="storageid">
	        	storageid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	createdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="unitid">
	        	unitid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	fqty
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	fbatchno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="poorderno">
	        	poorderno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcinterid">
	        	fsrcinterid
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="orderid">
	        	orderid
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="fxmark">
	        	fxmark
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="makecodeNumber">
	        	makecodeNumber
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="waitid">
	        	waitid
	        </isNotEmpty>
        ) VALUES (
        	
	        	#finterid# ,
	        	#itemcode# 
	        <isNotEmpty prepend="," property="storageid">
	        	 #storageid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	#createdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="unitid">
	        	#unitid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	#fqty# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	#fbatchno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="poorderno">
	        	#poorderno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcinterid">
	        	#fsrcinterid# 
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="orderid">
	        	#orderid# 
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="fxmark">
	        	#fxmark#
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="makecodeNumber">
	        	#makecodeNumber#
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="waitid">
	        	#waitid#
	        </isNotEmpty>
        )
   
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="entityid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>
    
    
 
    <insert id="Putstorageentity.insert.returnGoods.new.data" ><!-- 退货数据保存入库明细 -->
   
        INSERT INTO
        t_putstorageentity (
        	
	        	finterid ,
	        
	        	itemcode
	        <isNotEmpty prepend="," property="storageid">
	        	storageid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	createdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="unitid">
	        	unitid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	fqty
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	fbatchno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="poorderno">
	        	poorderno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcinterid">
	        	fsrcinterid
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="orderid">
	        	orderid
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="fxmark">
	        	fxmark
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="remarks">
	        	remarks
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="fsourcewin">
	        	fsourcewin
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="makecodeNumber">
	        	makecodeNumber
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="oldentityid">
	        	oldentityid
	        </isNotEmpty>
	        
        ) VALUES (
        	
	        	#finterid# ,
	        	#itemcode# 
	        <isNotEmpty prepend="," property="storageid">
	        	 #storageid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	#createdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="unitid">
	        	#unitid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	#fqty# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	#fbatchno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="poorderno">
	        	#poorderno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcinterid">
	        	#fsrcinterid# 
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="orderid">
	        	#orderid# 
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="fxmark">
	        	#fxmark#
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="remarks">
	        	#remarks#
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="fsourcewin">
	        	#fsourcewin#
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="makecodeNumber">
	        	#makecodeNumber#
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="oldentityid">
	        	#oldentityid#
	        </isNotEmpty>
        )
   
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="entityid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>

	<update id="Putstorageentity.update" parameterClass="com.terrence.crm.dol.bean.Putstorageentity">         
        UPDATE t_putstorageentity 
        <dynamic prepend="SET">
	        <isNotEmpty prepend="," property="finterid">
	        	finterid = #finterid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="itemcode">
	        	itemcode = #itemcode# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="storageid">
	        	storageid = #storageid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	createdate = #createdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="unitid">
	        	unitid = #unitid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	fqty = #fqty# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	fbatchno = #fbatchno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="poorderno">
	        	poorderno = #poorderno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcinterid">
	        	fsrcinterid = #fsrcinterid# 
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="orderid">
	        	orderid = #orderid# 
	        </isNotEmpty>
	        
	          <isNotEmpty prepend="," property="fxmark">
	        	fxmark = #fxmark# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcommitqy">
	        	fcommitqy = #fcommitqy# 
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="oldentityid">
	        	oldentityid = #oldentityid# 
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="tovoid">
	        	tovoid = #tovoid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="makecodeNumber">
	        	makecodeNumber = #makecodeNumber# 
	        </isNotEmpty>
	    </dynamic>
        WHERE 
	        entityid = #entityid# 
    </update>
    
	<delete id="Putstorageentity.delete" parameterClass="java.lang.Long">
    <![CDATA[
        delete from t_putstorageentity where
       entityid = #entityid# 
    ]]>
    </delete>
    
    <delete id="Putstorageentity.deleteMultiple">
    <![CDATA[
        DELETE FROM 
        	t_putstorageentity 
        WHERE
       entityid in ($entityid$) 
    ]]>
    </delete>
    
    <select id="Putstorageentity.getById" resultMap="RM.Putstorageentity">
	    select <include refid="Putstorageentity.columns"/>
	    
	        from t_putstorageentity 
	        where 
		        entityid = #entityid# 
	    
    </select>
    
	<select id="Putstorageentity.getByProperty" resultMap="RM.Putstorageentity">
		select <include refid="Putstorageentity.columns"/> from t_putstorageentity where $propertyName$=#propertyValue#
	</select>
	
	<sql id="Putstorageentity.findPage.where">
	    <dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="entityid">
	             t_putstorageentity.entityid = #entityid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="finterid">
	             t_putstorageentity.finterid = #finterid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="itemcode">
	             t_putstorageentity.itemcode = #itemcode#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="storageid">
	             t_putstorageentity.storageid = #storageid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="createdateBegin">
	             t_putstorageentity.createdate &gt;= #createdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="createdateEnd">
	             t_putstorageentity.createdate &lt;= #createdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="unitid">
	             t_putstorageentity.unitid = #unitid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fqty">
	             t_putstorageentity.fqty = #fqty#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbatchno">
	             t_putstorageentity.fbatchno = #fbatchno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="poorderno">
	             t_putstorageentity.poorderno = #poorderno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsrcinterid">
	             t_putstorageentity.fsrcinterid = #fsrcinterid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="orderid">
	             t_putstorageentity.orderid = #orderid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="makecodeNumber">
	             t_putstorageentity.makecodeNumber = #makecodeNumber#
	       </isNotEmpty>
	    </dynamic>	
	</sql>
	 
    <sql id="Putstorageentity.findPage.and">
			<isNotEmpty prepend="AND" property="entityid">
	             t_putstorageentity.entityid = #entityid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="finterid">
	             t_putstorageentity.finterid = #finterid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="itemcode">
	             t_putstorageentity.itemcode = #itemcode#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="storageid">
	             t_putstorageentity.storageid = #storageid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="createdateBegin">
	             t_putstorageentity.createdate &gt;= #createdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="createdateEnd">
	             t_putstorageentity.createdate &lt;= #createdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="unitid">
	             t_putstorageentity.unitid = #unitid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fqty">
	             t_putstorageentity.fqty = #fqty#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fbatchno">
	             t_putstorageentity.fbatchno = #fbatchno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="poorderno">
	             t_putstorageentity.poorderno = #poorderno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsrcinterid">
	             t_putstorageentity.fsrcinterid = #fsrcinterid#
	       </isNotEmpty>
	        <isNotEmpty prepend="AND" property="orderid">
	             t_putstorageentity.orderid = #orderid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="makecodeNumber">
	             t_putstorageentity.makecodeNumber = #makecodeNumber#
	       </isNotEmpty>
	</sql>
	
	<!-- ============================================================== -->
		<sql id="Putstorageentity.findPage.putstorage.where">
	    <dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="entityid">
	             t_putstorageentity.entityid = #entityid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="finterid">
	             t_putstorageentity.finterid = #finterid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="itemcode">
	             t_putstorageentity.itemcode = #itemcode#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="storageid">
	             t_putstorageentity.storageid = #storageid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="createdateBegin">
	             t_putstorageentity.createdate &gt;= #createdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="createdateEnd">
	             t_putstorageentity.createdate &lt;= #createdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="unitid">
	             t_putstorageentity.unitid = #unitid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fqty">
	             t_putstorageentity.fqty = #fqty#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbatchno">
	             t_putstorageentity.fbatchno = #fbatchno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="poorderno">
	             t_putstorageentity.poorderno = #poorderno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsrcinterid">
	             t_putstorageentity.fsrcinterid = #fsrcinterid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="empid">
	             t_admin.adminId = #empid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="supplierid">
	             t_supplier.supplierid = #supplierid#
	       </isNotEmpty>
	         <isNotEmpty prepend="AND" property="stockid">
	             t_stock.fitemid = #stockid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="status">
	             t_putstorage.status = #status#
	       </isNotEmpty>
	        <isNotEmpty prepend="AND" property="orderid">
	             t_putstorageentity.orderid = #orderid#
	       </isNotEmpty>
	       	<isNotEmpty prepend="AND" property="fxmark">
	    		  t_putstorageentity.fxmark = #fxmark#
	    	</isNotEmpty>  
	       <isNotEmpty prepend="AND" property="makecodeNumber">
	             t_putstorageentity.makecodeNumber = #makecodeNumber#
	       </isNotEmpty>
	    </dynamic>	
	</sql>
	 
    <sql id="Putstorageentity.findPage.putstorage.and">
			<isNotEmpty prepend="AND" property="entityid">
	             t_putstorageentity.entityid = #entityid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="finterid">
	             t_putstorageentity.finterid = #finterid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="itemcode">
	             t_putstorageentity.itemcode like ('%$itemcode$%')
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="storageid">
	             t_putstorageentity.storageid = #storageid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="createdateBegin">
	              convert(char(10),t_putstorageentity.createdate,120) &gt;= #createdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="createdateEnd">
	              convert(char(10),t_putstorageentity.createdate,120) &lt;= #createdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="unitid">
	             t_putstorageentity.unitid = #unitid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fqty">
	             t_putstorageentity.fqty = #fqty#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fbatchno">
	             t_putstorageentity.fbatchno = #fbatchno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="poorderno">
	             t_putstorageentity.poorderno like ('%$poorderno$%')
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsrcinterid">
	             t_putstorageentity.fsrcinterid = #fsrcinterid#
	       </isNotEmpty>
	        <isNotEmpty prepend="AND" property="empid">
	             t_admin.adminId = #empid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="supplierid">
	             t_supplier.supplierid = #supplierid#
	       </isNotEmpty>
	         <isNotEmpty prepend="AND" property="stockid">
	             t_stock.fitemid = #stockid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="status">
	             t_putstorage.status = #status#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="noExamStatus">
	             t_putstorage.status != #noExamStatus#
	       </isNotEmpty>
	        <isNotEmpty prepend="AND" property="orderid">
	             t_putstorageentity.orderid = #orderid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="checkdateBegin">
	             convert(char(10),t_putstorage.checkdate,120) &gt;= #checkdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="checkdateEnd">
	             convert(char(10),t_putstorage.checkdate,120) &lt;= #checkdateEnd#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fbillno">
	    	t_putstorage.fbillno like ('%$fbillno$%')
	    	</isNotEmpty> 
	    	
	    	<isNotEmpty prepend="AND" property="fxmark">
	    		  t_putstorageentity.fxmark = #fxmark#
	    	</isNotEmpty>  
	       <isNotEmpty prepend="AND" property="makecodeNumber">
	             t_putstorageentity.makecodeNumber = #makecodeNumber#
	       </isNotEmpty>
	       
	</sql>
	
	<!-- ============================================================== -->
	
    <select id="Putstorageentity.Entity" resultMap="RM.Putstorageentity">
    	SELECT 	<include refid="Putstorageentity.columns"/> FROM t_putstorageentity <include refid="Putstorageentity.findPage.where"/>
    </select>
    
    <select id="Putstorageentity.findList" resultMap="RM.Putstorageentity">
    	SELECT 
    		<include refid="Putstorageentity.columns"/> 
    	FROM 
    		t_putstorageentity
		<include refid="Putstorageentity.findPage.where"/>
		<isNotEmpty property="sortColumns">
			ORDER BY $sortColumns$
		</isNotEmpty>
    </select>
    
    <select id="Putstorageentity.findPage.count" resultClass="long">
    <![CDATA[
        select 
        count(*)
        from t_putstorageentity
    ]]>
		<include refid="Putstorageentity.findPage.where"/>    
    </select>
    <!--
    	分页查询已经使用Dialect进行分页,也可以不使用Dialect直接编写分页
    	因为分页查询将传 #offset#,#pageSize#,#lastRows# 三个参数,不同的数据库可以根于此三个参数属性应用不同的分页实现
    -->
    <select id="Sql.Putstorageentity.findPage" resultMap="RM.Putstorageentity">
    	select <include refid="Putstorageentity.columns"/>	    
	        from t_putstorageentity 	   
		<include refid="Putstorageentity.findPage.where"/>		
		<isNotEmpty property="sortColumns">ORDER BY $sortColumns$</isNotEmpty>
		
    </select>
    
	<select id="Putstorageentity.findPage" resultMap="RM.Putstorageentity">
    	select <include refid="Putstorageentity.columns"/>	    
	        from t_putstorageentity where 1=1 
	   <isNotEmpty property="notTop">  and 
       entityid 
	   not in(select $notTop$ 
       entityid 
	   from t_putstorageentity <include refid="Putstorageentity.findPage.where"/>
	   	   <isNotEmpty property="sortColumns"> ORDER BY $sortColumns$	</isNotEmpty>) 
	   	</isNotEmpty>    
	   	<include refid="Putstorageentity.findPage.and"/>
    	<isNotEmpty property="sortColumns">
			ORDER BY $sortColumns$
		</isNotEmpty>
    </select>
    
    
    
     <select id="Putstorageentity.findPage.for.putstorage.count" resultClass="long"><!-- 入库单列表 -->
    <![CDATA[
        select 
        count(*)
        from t_putstorageentity
         left join t_putstorage on t_putstorageentity.finterid = t_putstorage.finterid
	        left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
	        left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
	        left join t_supplier on t_putstorage.supplier = t_supplier.supplierid
	        left join t_admin on t_putstorage.empid = t_admin.adminId
	        left join t_admin sh on t_putstorage.checker = sh.adminId  
	        left join t_admin zd on t_putstorage.maker = zd.adminId
    ]]>
    where 1=1
     <isNotEmpty prepend="" property="teamid">
     	and t_putstorageentity.storageid in(select t_dept_stock.fitemid from t_dept_stock where t_dept_stock.teamid=#teamid#) and t_putstorageentity.tovoid is null and t_putstorage.status != 3
     </isNotEmpty>
       <isNotEmpty prepend="" property="nameitem">
		     	and  t_base_item.itemname   like ('%$nameitem$%')
		</isNotEmpty>
		<include refid="Putstorageentity.findPage.putstorage.and"/>  
		
    </select>
    <select id="Putstorageentity.findPage.for.putstorage" resultMap="RM.Putstorageentity.putstorageentity.list"><!-- 入库单列表 -->
    	select <include refid="Putstorageentity.columns"/>	,t_admin.adminName,sh.adminName  shname,zd.adminName zdname,t_supplier.fname,t_stock.fname stname,
    			t_base_item.fissnmanager,t_base_item.unitname,t_base_item.itemname ,t_base_item.formatno,t_putstorage.finterid ,t_putstorage.fbillno ,t_putstorage.creatdate ,
        	t_putstorage.isclose ,t_putstorage.status ,t_putstorage.supplier ,t_putstorage.empid ,t_putstorage.isreturn,
        	t_putstorage.checker ,t_putstorage.fstatusDesc ,t_putstorage.maker,t_putstorage.checkdate ,t_putstorage.srctype  
	        from t_putstorageentity
	        left join t_putstorage on t_putstorageentity.finterid = t_putstorage.finterid
	        left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
	        left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
	        left join t_supplier on t_putstorage.supplier = t_supplier.supplierid
	        left join t_admin on t_putstorage.empid = t_admin.adminId
	        left join t_admin sh on t_putstorage.checker = sh.adminId  
	        left join t_admin zd on t_putstorage.maker = zd.adminId
	        
	        
	        where 1=1 
	        <isNotEmpty prepend="" property="teamid">
		     	and  t_putstorageentity.storageid in(select t_dept_stock.fitemid from t_dept_stock where t_dept_stock.teamid=#teamid#)  and t_putstorageentity.tovoid is null  and t_putstorage.status != 3
		     </isNotEmpty>
		      <isNotEmpty prepend="" property="nameitem">
		     	and  t_base_item.itemname  like ('%$nameitem$%')
		     </isNotEmpty>
	   <isNotEmpty property="notTop">  and 
       t_putstorageentity.entityid 
	   not in(select $notTop$ 
       t_putstorageentity.entityid 
	   from t_putstorageentity 
	   left join t_putstorage on t_putstorageentity.finterid = t_putstorage.finterid
	    left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
	        left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
	        left join t_supplier on t_putstorage.supplier = t_supplier.supplierid
	        left join t_admin on t_putstorage.empid = t_admin.adminId
	        left join t_admin sh on t_putstorage.checker = sh.adminId  
	        left join t_admin zd on t_putstorage.maker = zd.adminId
	    where 1=1 
	    <isNotEmpty prepend="" property="teamid">
		    and t_putstorageentity.storageid in(select t_dept_stock.fitemid from t_dept_stock where t_dept_stock.teamid=#teamid#)  and t_putstorageentity.tovoid is null  and t_putstorage.status != 3
		 </isNotEmpty>
		 <isNotEmpty prepend="" property="nameitem">
		    and  t_base_item.itemname=#nameitem#
		 </isNotEmpty>
	    <include refid="Putstorageentity.findPage.putstorage.and"/>
	    
	   	 ORDER BY t_putstorage.fbillno DESC, t_putstorageentity.entityid  DESC 
	   	 <isNotEmpty prepend=","  property="sortColumns">
			 $sortColumns$
		</isNotEmpty>
	   	 
	   	  ) 
	   	</isNotEmpty>    
	   	<include refid="Putstorageentity.findPage.putstorage.and"/>
	   	
    	 ORDER BY t_putstorage.fbillno DESC, t_putstorageentity.entityid  DESC 
    	<isNotEmpty prepend=","  property="sortColumns">
			 $sortColumns$
		</isNotEmpty>
    </select>
    
    
    
      <select id="Putstorageentity.find.putList" resultMap="RM.Putstorageentity.for.find.putList"><!-- 查询入库明细 -->
    	SELECT 
    		<include refid="Putstorageentity.columns"/> 
    		,t_base_item.unitname,t_base_item.itemname ,t_base_item.formatno,t_base_item.isbatch
    		,t_base_item.fissnmanager,t_assembly_task.jobno taskjobno
    	FROM 
    		t_putstorageentity
    		   left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
    		    left join t_assembly_task on t_putstorageentity.poorderno = t_assembly_task.taskcode
    		   
    		   where finterid in ($finterids$)
    		
    		
    </select>
    
    
       <select id="Putstorageentity.find.tongbu.list" resultMap="RM.Putstorageentity">
    	SELECT 	<include refid="Putstorageentity.columns"/> FROM t_putstorageentity where finterid = #finterid#
    </select>
        
       <select id="Putstorageentity.find.tongbudata.list" resultMap="RM.Putstorageentity.select.add.stockname"><!-- 查询同步数据 2014610-->
    	SELECT 	<include refid="Putstorageentity.columns"/>,t_stock.fname stname ,t_assembly_task.jobno taskjobno
    	
    	FROM t_putstorageentity
    	left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
    	left join t_assembly_task on t_putstorageentity.poorderno = t_assembly_task.taskcode
    	
    	 where finterid = #finterid#
    </select>
	
	<select id="Putstorageentity.find.baseitem.in.Putstorageentity" resultMap="RM.BaseItem.in.Putstorageentity.tongbudata">
		SELECT fitemid,unitid from t_base_item where itemcode = #itemcode#
	</select>
	
	<select id="Putstorageentity.find.poorderentry.in.tongbu" resultMap="RM.Poorderentry.putstorageentity.tongbu">
		SELECT t_poorderentry.orderid ,
        	t_poorderentry.finterid ,
        	t_poorderentry.itemcode ,
        	t_poorderentry.itemname ,
        	t_poorderentry.itemmode ,
        	t_poorderentry.price ,
        	t_poorderentry.fqty ,
        	t_poorderentry.unitname ,
        	t_poorderentry.mrpclosed ,
        	t_poorderentry.itemid ,
        	t_poorderentry.sendstatus ,
        	t_poorderentry.sendtime ,
        	t_poorderentry.createtime ,
        	t_poorderentry.buystatus ,
        	t_poorderentry.fcurrencyid ,
        	t_poorderentry.ftaxprice ,
        	t_poorderentry.ftaxamount ,
        	t_poorderentry.famount ,
        	t_poorderentry.fdate ,
        	t_poorderentry.f_101 ,
        	t_poorderentry.f_102 ,
        	t_poorderentry.empid ,
        	t_poorderentry.deptid ,
        	t_poorderentry.ispush ,
        	t_poorderentry.anumber ,
        	t_poorderentry.fsourcebillno ,
        	t_poorderentry.issync ,
        	t_poorderentry.reqcomment ,
        	t_poorderentry.fcomment ,
        	t_poorderentry.supplierid ,
        	t_poorderentry.fcess ,
        	t_poorderentry.bought,
        	t_poorderentry.putqty ,
        	t_poorder.fexchangerate fexchangerate
        	from 	t_poorderentry 
        	left join t_poorder on t_poorderentry.finterid  =  t_poorder.finterid
        	where  orderid = #orderid#
	</select>
	
	   <select id="Putstorageentity.find.delete.entity" resultMap="RM.Putstorageentity.tongbudata">
    	SELECT 	<include refid="Putstorageentity.columns"/> FROM t_putstorageentity where entityid = #entityid#
    </select>
    
      <select id="Putstorageentity.find.listPustorageentity" resultMap="RM.Putstorageentity.tongbudata">
    	SELECT 	<include refid="Putstorageentity.columns"/> FROM t_putstorageentity where finterid = #finterid#
    </select>
	
	 <select id="Putstorageentity.find.list.batchno" resultMap="RM.Putstorageentity.tongbudata">
    	SELECT 	<include refid="Putstorageentity.columns"/> FROM t_putstorageentity where 1=1
    		and	(fxmark = #fxmark# or fxmark is null)
    		<isNotEmpty prepend="AND" property="itemcode">
	             t_putstorageentity.itemcode = #itemcode#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="storageid">
	             t_putstorageentity.storageid = #storageid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbatchno">
	             t_putstorageentity.fbatchno like ('%$fbatchno$%')
	       </isNotEmpty>
	       
    </select>

 <insert id="Putstorageentity.insert.in.TQIN" ><!-- 其他入库添加到待入库明细wzx -->
   
        INSERT INTO
        t_putstorageentity (
        	
	        	finterid ,
	        
	        	itemcode
	        <isNotEmpty prepend="," property="storageid">
	        	storageid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	createdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="unitid">
	        	unitid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	fqty
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	fbatchno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="poorderno">
	        	poorderno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcinterid">
	        	fsrcinterid
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="orderid">
	        	orderid
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="makecodeNumber">
	        	makecodeNumber
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="fxmark">
	        	fxmark
	        </isNotEmpty>
        ) VALUES (
        	
	        	#finterid# ,
	        	#itemcode# 
	        <isNotEmpty prepend="," property="storageid">
	        	 #storageid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	#createdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="unitid">
	        	#unitid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	#fqty# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	#fbatchno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="poorderno">
	        	#poorderno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcinterid">
	        	#fsrcinterid# 
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="orderid">
	        	#orderid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="makecodeNumber">
	        	#makecodeNumber#
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="fxmark">
	        	#fxmark#
	        </isNotEmpty>
        )
   
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="entityid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>



<select id="Putstorageentity.find.returnGoods.data" resultMap="RM.Putstorageentity.returnGoods.data.list"><!-- 退库数据查询 -->
	    select <include refid="Putstorageentity.columns"/>,t_admin.adminName,sh.adminName  shname,zd.adminName zdname,t_supplier.fname,t_stock.fname stname,
    			t_base_item.fissnmanager,t_base_item.unitname,t_base_item.itemname ,t_base_item.formatno,t_putstorage.finterid ,t_putstorage.fbillno ,t_putstorage.creatdate ,
        	t_putstorage.isclose ,t_putstorage.status ,t_putstorage.supplier ,t_putstorage.empid ,t_putstorage.isreturn,
        	t_putstorage.checker ,t_putstorage.maker,t_putstorage.checkdate ,t_putstorage.fstatusDesc,t_putstorage.srctype
	        from t_putstorageentity 
	        left join t_putstorage on t_putstorageentity.finterid = t_putstorage.finterid
	        left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
	        left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
	        left join t_supplier on t_putstorage.supplier = t_supplier.supplierid
	        left join t_admin on t_putstorage.empid = t_admin.adminId
	        left join t_admin sh on t_putstorage.checker = sh.adminId  
	        left join t_admin zd on t_putstorage.maker = zd.adminId
	        where 
		        entityid  in ($entityids$) 
	    
    </select>


 <select id="Putstorageentity.find.tovoid.listData" resultMap="RM.Putstorageentity.fk.tovoid.data"><!-- 作废数据查询 -->
    	SELECT 	<include refid="Putstorageentity.columns"/> 
    	FROM t_putstorageentity  
    	
    	where poorderno=#poorderno#
    </select>
    
     <select id="Putstorageentity.find.mingix.tovoid.data" resultMap="RM.Putstorageentity.fk.tovoid.data"><!-- 作废数据查询 -->
    	SELECT 	<include refid="Putstorageentity.columns"/> 
    	FROM t_putstorageentity  
    	
    	where finterid = #finterid# and tovoid is null
    </select>
    
     <select id="Putstorageentity.find.fanshen.data" resultMap="RM.Putstorageentity"><!-- 出库单反审查询数据-->
    	SELECT 	<include refid="Putstorageentity.columns"/> 
    	FROM t_putstorageentity  
    	
    	where poorderno = #poorderno# and fbatchno = #fbatchno#  and tovoid is null
    </select>
	
	<select id="Putstorageentity.find.batchno.itemcode" resultMap="RM.Putstorageentity"><!-- 201140815 采购订单下推时批次号查询 -->
    	SELECT 	<include refid="Putstorageentity.columns"/> 
    	FROM t_putstorageentity  
    	
    	where t_putstorageentity.itemcode=#itemcode# and  t_putstorageentity.fbatchno like ('%$fbatchno$%')
    </select>

<select id="Putstorageentity.findList.Byfinterid" resultMap="RM.Putstorageentity.findList.Byfinterid">
    	SELECT 	 
    	t_putstorageentity.itemcode
    	,t_putstorageentity.entityid
    	,t_putstorageentity.fbatchno
    	
    	FROM t_putstorageentity  
    	
    	where
    	1=1
    	<isNotEmpty prepend="AND" property="finterid">
    	t_putstorageentity.finterid=#finterid#
    	</isNotEmpty> 
    	<isNotEmpty prepend="AND" property="fbatchno">
    	t_putstorageentity.fbatchno=#fbatchno#
    	</isNotEmpty> 
    	
    </select>

<select id="Putstorageentity.findList.ByfinteridWaiGou" resultMap="RM.Putstorageentity.findList.Byfinterid">
    	SELECT 	 
    	t_putstorageentity.itemcode
    	,t_putstorageentity.entityid
    	,t_icserial.fserialnum fbatchno
    	
    	FROM t_putstorageentity  
    		left join t_icserial on t_putstorageentity.orderid=   t_icserial.finterid
    	where
    	1=1 and  t_icserial.ftrantypeid=71       
    	<isNotEmpty prepend="AND" property="finterid">
    	t_putstorageentity.finterid=#finterid#
    	</isNotEmpty> 
    	<isNotEmpty prepend="AND" property="fbatchno">
    	t_icserial.fserialnum=#fbatchno#
    	</isNotEmpty> 
    	
    </select>

<select id="Putstorageentity.findList.ByfinteridJiJia" resultMap="RM.Putstorageentity.findList.Byfinterid">
    	SELECT 	 
    	t_putstorageentity.itemcode
    	,t_putstorageentity.entityid
    	,t_icserial.fserialnum fbatchno
    	
    	FROM t_putstorageentity  
    		left join t_icserial on t_putstorageentity.entityid=t_icserial.finterid
    	where
    	1=1 and  t_icserial.ftrantypeid=85       
    	<isNotEmpty prepend="AND" property="finterid">
    	t_putstorageentity.finterid=#finterid#
    	</isNotEmpty> 
    	<isNotEmpty prepend="AND" property="fbatchno">
    	t_icserial.fserialnum=#fbatchno#
    	</isNotEmpty> 
    	
    </select>

	<select id="Putstorageentity.find.only.data.putentity" resultMap="RM.Putstorageentity"><!-- 查询 -->
		select <include refid="Putstorageentity.columns"/> from t_putstorageentity where fbatchno = #fbatchno# and tovoid != 1
	</select>
	
	<select id="Putstorageentity.find.excelOut.data" resultMap="MR.Putstorageentity.excelOut.putData"><!-- 入库单明细导出数据查询 -->
		select t_base_item.unitname,t_base_item.itemname,t_base_item.formatno,t_stock.fname stname,t_supplier.fname suppername,t_base_item.f_102,
			t_putstorageentity.entityid ,t_putstorageentity.itemcode ,t_putstorageentity.createdate ,t_putstorageentity.fqty ,
        	t_putstorageentity.fbatchno ,t_putstorageentity.poorderno ,t_putstorageentity.fxmark,t_putstorage.fbillno,t_putstorage.checkdate,t_putstorage.creatdate,
        	t_poorderentry.f_101,t_poorderentry.ftaxprice,t_department.teamname teamname
		from t_putstorageentity 
			left join t_putstorage on t_putstorageentity.finterid = t_putstorage.finterid
			left join t_poorderentry on t_putstorageentity.orderid = t_poorderentry.orderid
			left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
			left join t_supplier on t_putstorage.supplier = t_supplier.supplierid
			left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
			left join t_department on t_poorderentry.deptid = t_department.teamid
			where 1=1 and t_putstorageentity.finterid in ($finterids$)
		    
	</select>
	
	<select id="Putstorageentity.select.data.for.saleOut" resultMap="MR.putstorageentity.and.putstorage.select.data">
		select t_putstorageentity.entityid,t_putstorageentity.itemcode,t_putstorageentity.storageid,t_putstorageentity.unitid,
		t_putstorageentity.fqty,t_putstorageentity.fbatchno,t_base_item.unitname,t_base_item.itemname,t_base_item.formatno,
		t_stock.fname stname,t_putstorage.fbillno,t_putstorage.checkdate,t_poorderentry.price,t_poorderentry.ftaxprice,
		t_putstorageentity.fxmark,t_poorderentry.fcomment,t_putstorageentity.poorderno,t_putstorage.status
		from t_putstorageentity
		left join t_putstorage on t_putstorageentity.finterid = t_putstorage.finterid
		left join t_poorderentry on t_putstorageentity.orderid = t_poorderentry.orderid
		left join t_supplier on t_poorderentry.supplierid = t_supplier.supplierid
		left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
		left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
		where 1=1  and t_putstorage.srctype=71 and ( t_putstorage.isreturn is null or t_putstorage.isreturn!=1 ) and t_putstorageentity.issaleOut=0
		and t_putstorage.checkdate >'2014-12-31' 
		<isNotEmpty prepend="AND" property="itemname">
	             t_base_item.itemname like ('%$itemname$%')
	   </isNotEmpty>
	   <isNotEmpty prepend="AND" property="supperName">
	   			 t_supplier.fname like ('%$supperName$%')
	   </isNotEmpty>
		
		<include refid="Putstorageentity.findPage.putstorage.and"/> 
	</select>
	
	<select id="Putstorageentity.find.saleout.data.for.addtable" resultMap="New.RM.Putstorageentity.for.entity.select">
		select <include refid="Putstorageentity.columns"/> ,t_base_item.unitname,t_base_item.itemname,t_base_item.formatno,
		t_stock.fname stname,t_putstorage.fbillno,t_poorderentry.price,t_poorderentry.ftaxprice,t_base_item.fissnmanager,t_poorderentry.fcomment
		
		from t_putstorageentity 
		left join t_putstorage on t_putstorageentity.finterid = t_putstorage.finterid
		left join t_poorderentry on t_putstorageentity.orderid = t_poorderentry.orderid
		left join t_stock on t_putstorageentity.storageid = t_stock.fitemid
		left join t_base_item on t_putstorageentity.itemcode = t_base_item.itemcode
		
		where entityid in ($entityids$)
	</select>
	
	<select id="Putsroageentity.find.fqtyEntity.for.jijia" resultMap="Putstorageentity.for.fqty.jijia.icmo">
		select sum(fqty) fqty from t_putstorageentity where poorderno = #poorderno#
	</select>
	
	<select id="Putstoageentity.select.fqty.sum.baseitem.data" resultMap="entity.select.sumfqty.data.change.baseitem">
		select sum(fqty) fqty from t_putstorageentity 
		where orderid = #orderid#
	</select>
	
</sqlMap>
