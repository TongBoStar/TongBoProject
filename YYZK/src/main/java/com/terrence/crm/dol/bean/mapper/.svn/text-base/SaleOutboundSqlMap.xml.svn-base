<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="SaleOutbound">

        
	<resultMap id="RM.SaleOutbound" class="com.terrence.crm.dol.bean.SaleOutbound">
        <result property="saleid" column="saleid"/>
        <result property="fmarketingstyle" column="fmarketingstyle"/>
        <result property="ffetchdate" column="ffetchdate"/>
        <result property="ffetchadd" column="ffetchadd"/>
        <result property="fconsignee" column="fconsignee"/>
        <result property="fsalestyle" column="fsalestyle"/>
        <result property="fexplanation" column="fexplanation"/>
        <result property="fbillno" column="fbillno"/>
        <result property="fseltrantype" column="fseltrantype"/>
        <result property="fchoosebillno" column="fchoosebillno"/>
        <result property="fscstockid" column="fscstockid"/>
        <result property="fsendempid" column="fsendempid"/>
        <result property="fcheckerid" column="fcheckerid"/>
        <result property="fdeptid" column="fdeptid"/>
        <result property="fcheckdate" column="fcheckdate"/>
        <result property="fdate" column="fdate"/>
        <result property="fmanagerid" column="fmanagerid"/>
        <result property="fposterid" column="fposterid"/>
        <result property="fempid" column="fempid"/>
        <result property="fsmanagerid" column="fsmanagerid"/>
        <result property="fbillerid" column="fbillerid"/>
        <result property="fpoordbillno" column="fpoordbillno"/>
        <result property="ffrom" column="ffrom"/>
        <result property="fstatus" column="fstatus"/>
        <result property="isreturn" column="isreturn"/>
    </resultMap>
	
	
	<resultMap id="RM.SaleOutbound.check.detail.find" class="com.terrence.crm.dol.bean.SaleOutbound"><!-- 待审核销售出库单明细查询 -->
        <result property="saleid" column="saleid"/>
        <result property="fmarketingstyle" column="fmarketingstyle"/>
        <result property="ffetchdate" column="ffetchdate"/>
        <result property="ffetchadd" column="ffetchadd"/>
        <result property="fconsignee" column="fconsignee"/>
        <result property="fsalestyle" column="fsalestyle"/>
        <result property="fexplanation" column="fexplanation"/>
        <result property="fbillno" column="fbillno"/>
        <result property="fseltrantype" column="fseltrantype"/>
        <result property="fchoosebillno" column="fchoosebillno"/>
        <result property="fscstockid" column="fscstockid"/>
        <result property="fsendempid" column="fsendempid"/>
        <result property="fcheckerid" column="fcheckerid"/>
        <result property="fdeptid" column="fdeptid"/>
        <result property="fcheckdate" column="fcheckdate"/>
        <result property="fdate" column="fdate"/>
        <result property="fmanagerid" column="fmanagerid"/>
        <result property="fposterid" column="fposterid"/>
        <result property="fempid" column="fempid"/>
        <result property="fsmanagerid" column="fsmanagerid"/>
        <result property="fbillerid" column="fbillerid"/>
        <result property="fpoordbillno" column="fpoordbillno"/>
        <result property="ffrom" column="ffrom"/>
        <result property="fstatus" column="fstatus"/>
        <result property="isreturn" column="isreturn"/>
        <result property="zdname" column="zdname"/>
        
        <result property="shname" column="shname"/>
        <result property="fhname" column="fhname"/>
        <result property="bmname" column="bmname"/>
        <result property="zgname" column="zgname"/>
        <result property="jzname" column="jzname"/>
        <result property="ywname" column="ywname"/>
        <result property="bgname" column="bgname"/>
        <result property="stockname" column="stockname"/>
        <result property="gwName" column="gwName"/>
    </resultMap>
    
    
    <!-- ========================================================== -->
    
    <resultMap id="RM.SaleOutbound.find.SalesSum.data" class="com.terrence.crm.dol.bean.SaleOutbound"><!-- 列表查询 -->
        <result property="saleid" column="saleid"/>
        <result property="fmarketingstyle" column="fmarketingstyle"/>
        <result property="ffetchdate" column="ffetchdate"/>
        <result property="ffetchadd" column="ffetchadd"/>
        <result property="fconsignee" column="fconsignee"/>
        <result property="fsalestyle" column="fsalestyle"/>
        <result property="fexplanation" column="fexplanation"/>
        <result property="fbillno" column="fbillno"/>
        <result property="fseltrantype" column="fseltrantype"/>
        <result property="fchoosebillno" column="fchoosebillno"/>
        <result property="fscstockid" column="fscstockid"/>
        <result property="fsendempid" column="fsendempid"/>
        <result property="fcheckerid" column="fcheckerid"/>
        <result property="fdeptid" column="fdeptid"/>
        <result property="fcheckdate" column="fcheckdate"/>
        <result property="fdate" column="fdate"/>
        <result property="fmanagerid" column="fmanagerid"/>
        <result property="fposterid" column="fposterid"/>
        <result property="fempid" column="fempid"/>
        <result property="fsmanagerid" column="fsmanagerid"/>
        <result property="fbillerid" column="fbillerid"/>
        <result property="fpoordbillno" column="fpoordbillno"/>
        <result property="ffrom" column="ffrom"/>
        <result property="fstatus" column="fstatus"/>
        <result property="isreturn" column="isreturn"/>
        <result property="zdname" column="zdname"/>
        
        <result property="shname" column="shname"/>
        <result property="fhname" column="fhname"/>
        <result property="bmname" column="bmname"/>
        <result property="zgname" column="zgname"/>
        <result property="jzname" column="jzname"/>
        <result property="ywname" column="ywname"/>
        <result property="bgname" column="bgname"/>
        <result property="stockname" column="stockname"/>
        <result property="gwName" column="gwName"/>
        
     
        
       <result property="salesDetailSumList" column="saleid" select="SalesDetailSum.find.mingxi.data.select"/> 
    </resultMap>
    
    
     <resultMap id="RM.SalesDetailSum.in.saleOutBound.top3" class="com.terrence.crm.dol.bean.SalesDetailSum">
        <result property="sdetailid" column="sdetailid"/>
        <result property="saleid" column="saleid"/>
        <result property="itemcode" column="itemcode"/>
        <result property="itemname" column="itemname"/>
        <result property="itemmode" column="itemmode"/>
        <result property="baseunitid" column="baseunitid"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="fqty" column="fqty"/>
        <result property="unitid" column="unitid"/>
        <result property="payfqty" column="payfqty"/>
        <result property="notes" column="notes"/>
        <result property="stockid" column="stockid"/>
        <result property="saleprice" column="saleprice"/>
        <result property="saleamount" column="saleamount"/>
        <result property="fsourcecode" column="fsourcecode"/>
        <result property="fdate" column="fdate"/>
        <result property="dbno" column="dbno"/>
        <result property="stockname" column="stockname"/>
        <result property="unitName" column="unitName"/>
        
        <result property="fissnmanager" column="fissnmanager"/>
        <result property="isbatch" column="isbatch"/>
    </resultMap>
    <!-- ============================================================ -->
	  

	<!-- 用于select查询公用抽取的列 -->
	<sql id="SaleOutbound.columns">
	    <![CDATA[
        	t_sale_outbound.saleid ,
        	t_sale_outbound.fmarketingstyle ,
        	t_sale_outbound.ffetchdate ,
        	t_sale_outbound.ffetchadd ,
        	t_sale_outbound.fconsignee ,
        	t_sale_outbound.fsalestyle ,
        	t_sale_outbound.fexplanation ,
        	t_sale_outbound.fbillno ,
        	t_sale_outbound.fseltrantype ,
        	t_sale_outbound.fchoosebillno ,
        	t_sale_outbound.fscstockid ,
        	t_sale_outbound.fsendempid ,
        	t_sale_outbound.fcheckerid ,
        	t_sale_outbound.fdeptid ,
        	t_sale_outbound.fcheckdate ,
        	t_sale_outbound.fdate ,
        	t_sale_outbound.fmanagerid ,
        	t_sale_outbound.fposterid ,
        	t_sale_outbound.fempid ,
        	t_sale_outbound.fsmanagerid ,
        	t_sale_outbound.fbillerid ,
        	t_sale_outbound.fpoordbillno ,

        	t_sale_outbound.ffrom ,
        	t_sale_outbound.fstatus,
        	t_sale_outbound.isreturn
        	

	    ]]>
	</sql>
	
   <insert id="SaleOutbound.insert" >
    <![CDATA[
        INSERT INTO
        t_sale_outbound (
        	fmarketingstyle ,
        	ffetchdate ,
        	ffetchadd ,
        	fconsignee ,
        	fsalestyle ,
        	fexplanation ,
        	fbillno ,
        	fseltrantype ,
        	fchoosebillno ,
        	fscstockid ,
        	fsendempid ,
        	fcheckerid ,
        	fdeptid ,
        	fcheckdate ,
        	fdate ,
        	fmanagerid ,
        	fposterid ,
        	fempid ,
        	fsmanagerid ,
        	fbillerid ,
        	fpoordbillno ,
        	ffrom ,
        	fstatus,
        	isreturn

  
        ) VALUES (
        	#fmarketingstyle# ,
        	#ffetchdate# ,
        	#ffetchadd# ,
        	#fconsignee# ,
        	#fsalestyle# ,
        	#fexplanation# ,
        	#fbillno# ,
        	#fseltrantype# ,
        	#fchoosebillno# ,
        	#fscstockid# ,
        	#fsendempid# ,
        	#fcheckerid# ,
        	#fdeptid# ,
        	#fcheckdate# ,
        	#fdate# ,
        	#fmanagerid# ,
        	#fposterid# ,
        	#fempid# ,
        	#fsmanagerid# ,
        	#fbillerid# ,
        	#fpoordbillno# ,
        	#ffrom# ,
        	#fstatus#,
        	#isreturn#
        )
    ]]> 
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="saleid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>
    
    
    
    <insert id="SaleOutbound.insert.new.data.save" ><!-- 保存表头数据 -->
  
        INSERT INTO
        t_sale_outbound (fbillerid,fstatus
        	<isNotEmpty prepend="," property="fmarketingstyle">
	        	fmarketingstyle
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchdate">
	        	ffetchdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchadd">
	        	ffetchadd
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fconsignee">
	        	fconsignee 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsalestyle">
	        	fsalestyle
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fexplanation">
	        	fexplanation
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbillno">
	        	fbillno 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fseltrantype">
	        	fseltrantype
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fchoosebillno">
	        	fchoosebillno 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fscstockid">
	        	fscstockid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsendempid">
	        	fsendempid 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckerid">
	        	fcheckerid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdeptid">
	        	fdeptid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckdate">
	        	fcheckdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdate">
	        	fdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fmanagerid">
	        	fmanagerid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fposterid">
	        	fposterid 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fempid">
	        	fempid
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsmanagerid">
	        	fsmanagerid
	        </isNotEmpty>
	      
	        <isNotEmpty prepend="," property="fpoordbillno">
	        	fpoordbillno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffrom">
	        	ffrom
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="isreturn">
	        	isreturn
	        </isNotEmpty>
        ) VALUES (#fbillerid#,#fstatus#
        	<isNotEmpty prepend="," property="fmarketingstyle">
	        	#fmarketingstyle# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchdate">
	        	#ffetchdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchadd">
	        	#ffetchadd# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fconsignee">
	        	#fconsignee# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsalestyle">
	        	#fsalestyle# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fexplanation">
	        	#fexplanation# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbillno">
	        	#fbillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fseltrantype">
	        	#fseltrantype# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fchoosebillno">
	        	#fchoosebillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fscstockid">
	        	#fscstockid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsendempid">
	        	#fsendempid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckerid">
	        	#fcheckerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdeptid">
	        	#fdeptid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckdate">
	        	#fcheckdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdate">
	        	#fdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fmanagerid">
	        	#fmanagerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fposterid">
	        	#fposterid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fempid">
	        	#fempid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsmanagerid">
	       		#fsmanagerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fpoordbillno">
	        	#fpoordbillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffrom">
	        	#ffrom# 
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="isreturn">
	        	#isreturn#
	        </isNotEmpty>
        )
 
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="saleid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>

	<update id="SaleOutbound.update" parameterClass="com.terrence.crm.dol.bean.SaleOutbound">         
        UPDATE t_sale_outbound 
        <dynamic prepend="SET">
	        <isNotEmpty prepend="," property="fmarketingstyle">
	        	fmarketingstyle = #fmarketingstyle# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchdate">
	        	ffetchdate = #ffetchdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchadd">
	        	ffetchadd = #ffetchadd# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fconsignee">
	        	fconsignee = #fconsignee# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsalestyle">
	        	fsalestyle = #fsalestyle# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fexplanation">
	        	fexplanation = #fexplanation# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbillno">
	        	fbillno = #fbillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fseltrantype">
	        	fseltrantype = #fseltrantype# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fchoosebillno">
	        	fchoosebillno = #fchoosebillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fscstockid">
	        	fscstockid = #fscstockid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsendempid">
	        	fsendempid = #fsendempid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckerid">
	        	fcheckerid = #fcheckerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdeptid">
	        	fdeptid = #fdeptid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckdate">
	        	fcheckdate = #fcheckdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdate">
	        	fdate = #fdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fmanagerid">
	        	fmanagerid = #fmanagerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fposterid">
	        	fposterid = #fposterid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fempid">
	        	fempid = #fempid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsmanagerid">
	        	fsmanagerid = #fsmanagerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbillerid">
	        	fbillerid = #fbillerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fpoordbillno">
	        	fpoordbillno = #fpoordbillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffrom">
	        	ffrom = #ffrom# 
	        </isNotEmpty>

	         <isNotEmpty prepend="," property="fstatus">
	        	fstatus = #fstatus# 
	        </isNotEmpty>
			 <isNotEmpty prepend="," property="isreturn">
	        	isreturn = #isreturn#
	        </isNotEmpty>

	    </dynamic>
        WHERE 
	        saleid = #saleid# 
    </update>
    
    
    
    
    <update id="SaleOutbound.update.data.saveAfter" parameterClass="com.terrence.crm.dol.bean.SaleOutbound"><!-- saleid更新 -->         
        UPDATE t_sale_outbound 
        <dynamic prepend="SET">
	        <isNotEmpty prepend="," property="fmarketingstyle">
	        	fmarketingstyle = #fmarketingstyle# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchdate">
	        	ffetchdate = #ffetchdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffetchadd">
	        	ffetchadd = #ffetchadd# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fconsignee">
	        	fconsignee = #fconsignee# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsalestyle">
	        	fsalestyle = #fsalestyle# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fexplanation">
	        	fexplanation = #fexplanation# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbillno">
	        	fbillno = #fbillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fseltrantype">
	        	fseltrantype = #fseltrantype# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fchoosebillno">
	        	fchoosebillno = #fchoosebillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fscstockid">
	        	fscstockid = #fscstockid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsendempid">
	        	fsendempid = #fsendempid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckerid">
	        	fcheckerid = #fcheckerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdeptid">
	        	fdeptid = #fdeptid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fcheckdate">
	        	fcheckdate = #fcheckdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fdate">
	        	fdate = #fdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fmanagerid">
	        	fmanagerid = #fmanagerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fposterid">
	        	fposterid = #fposterid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fempid">
	        	fempid = #fempid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsmanagerid">
	        	fsmanagerid = #fsmanagerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbillerid">
	        	fbillerid = #fbillerid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fpoordbillno">
	        	fpoordbillno = #fpoordbillno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ffrom">
	        	ffrom = #ffrom# 
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="fstatus">
	        	fstatus = #fstatus# 
	        </isNotEmpty>
	         <isNotEmpty prepend="," property="isreturn">
	        	isreturn = #isreturn#
	        </isNotEmpty>
	    </dynamic>
        WHERE 
	        saleid = #saleid# 
    </update>
    
	<delete id="SaleOutbound.delete" parameterClass="java.lang.Long">
    <![CDATA[
        delete from t_sale_outbound where
       saleid = #saleid# 
    ]]>
    </delete>
    
    <delete id="SaleOutbound.deleteMultiple">
    <![CDATA[
        DELETE FROM 
        	t_sale_outbound 
        WHERE
       saleid in ($saleid$) 
    ]]>
    </delete>
    
    <select id="SaleOutbound.getById" resultMap="RM.SaleOutbound">
	    select <include refid="SaleOutbound.columns"/>
	    
	        from t_sale_outbound 
	        where 
		        saleid = #saleid# 
	    
    </select>
    
	<select id="SaleOutbound.getByProperty" resultMap="RM.SaleOutbound">
		select <include refid="SaleOutbound.columns"/> from t_sale_outbound where $propertyName$=#propertyValue#
	</select>
	
	<sql id="SaleOutbound.findPage.where">
	    <dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="saleid">
	             t_sale_outbound.saleid = #saleid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fmarketingstyle">
	             t_sale_outbound.fmarketingstyle = #fmarketingstyle#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="ffetchdateBegin">
	             t_sale_outbound.ffetchdate &gt;= #ffetchdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="ffetchdateEnd">
	             t_sale_outbound.ffetchdate &lt;= #ffetchdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="ffetchadd">
	             t_sale_outbound.ffetchadd = #ffetchadd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fconsignee">
	             t_sale_outbound.fconsignee = #fconsignee#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsalestyle">
	             t_sale_outbound.fsalestyle = #fsalestyle#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fexplanation">
	             t_sale_outbound.fexplanation = #fexplanation#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbillno">
	             t_sale_outbound.fbillno = #fbillno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fseltrantype">
	             t_sale_outbound.fseltrantype = #fseltrantype#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fchoosebillno">
	             t_sale_outbound.fchoosebillno = #fchoosebillno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fscstockid">
	             t_sale_outbound.fscstockid = #fscstockid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsendempid">
	             t_sale_outbound.fsendempid = #fsendempid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fcheckerid">
	             t_sale_outbound.fcheckerid = #fcheckerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fdeptid">
	             t_sale_outbound.fdeptid = #fdeptid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fcheckdateBegin">
	             t_sale_outbound.fcheckdate &gt;= #fcheckdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fcheckdateEnd">
	             t_sale_outbound.fcheckdate &lt;= #fcheckdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fdateBegin">
	             t_sale_outbound.fdate &gt;= #fdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fdateEnd">
	             t_sale_outbound.fdate &lt;= #fdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fmanagerid">
	             t_sale_outbound.fmanagerid = #fmanagerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fposterid">
	             t_sale_outbound.fposterid = #fposterid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fempid">
	             t_sale_outbound.fempid = #fempid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsmanagerid">
	             t_sale_outbound.fsmanagerid = #fsmanagerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbillerid">
	             t_sale_outbound.fbillerid = #fbillerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fpoordbillno">
	             t_sale_outbound.fpoordbillno = #fpoordbillno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="ffrom">
	             t_sale_outbound.ffrom = #ffrom#
	       </isNotEmpty>

	       <isNotEmpty prepend="AND" property="fstatus">
	             t_sale_outbound.fstatus = #fstatus#
	       </isNotEmpty>
			 <isNotEmpty prepend="AND" property="isreturn">
	        	t_sale_outbound.isreturn = #isreturn#
	        </isNotEmpty>

	       
	    </dynamic>	
	</sql>
	
	
	 
    <sql id="SaleOutbound.findPage.and">
			<isNotEmpty prepend="AND" property="saleid">
	             t_sale_outbound.saleid = #saleid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fmarketingstyle">
	             t_sale_outbound.fmarketingstyle = #fmarketingstyle#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="ffetchdateBegin">
	             t_sale_outbound.ffetchdate &gt;= #ffetchdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="ffetchdateEnd">
	             t_sale_outbound.ffetchdate &lt;= #ffetchdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="ffetchadd">
	             t_sale_outbound.ffetchadd = #ffetchadd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fconsignee">
	             t_sale_outbound.fconsignee = #fconsignee#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsalestyle">
	             t_sale_outbound.fsalestyle = #fsalestyle#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fexplanation">
	             t_sale_outbound.fexplanation = #fexplanation#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fbillno">
	             t_sale_outbound.fbillno = #fbillno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fseltrantype">
	             t_sale_outbound.fseltrantype = #fseltrantype#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fchoosebillno">
	             t_sale_outbound.fchoosebillno = #fchoosebillno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fscstockid">
	             t_sale_outbound.fscstockid = #fscstockid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsendempid">
	             t_sale_outbound.fsendempid = #fsendempid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fcheckerid">
	             t_sale_outbound.fcheckerid = #fcheckerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fdeptid">
	             t_sale_outbound.fdeptid = #fdeptid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fcheckdateBegin">
	             t_sale_outbound.fcheckdate &gt;= #fcheckdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fcheckdateEnd">
	             t_sale_outbound.fcheckdate &lt;= #fcheckdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fdateBegin">
	             t_sale_outbound.fdate &gt;= #fdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fdateEnd">
	             t_sale_outbound.fdate &lt;= #fdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fmanagerid">
	             t_sale_outbound.fmanagerid = #fmanagerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fposterid">
	             t_sale_outbound.fposterid = #fposterid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fempid">
	             t_sale_outbound.fempid = #fempid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsmanagerid">
	             t_sale_outbound.fsmanagerid = #fsmanagerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fbillerid">
	             t_sale_outbound.fbillerid = #fbillerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fpoordbillno">
	             t_sale_outbound.fpoordbillno = #fpoordbillno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="ffrom">
	             t_sale_outbound.ffrom = #ffrom#
	       </isNotEmpty>

	         <isNotEmpty prepend="AND" property="fstatus">
	             t_sale_outbound.fstatus = #fstatus#
	       </isNotEmpty>
	        <isNotEmpty prepend="AND" property="isreturn">
	        	t_sale_outbound.isreturn = #isreturn#
	        </isNotEmpty>
	     
	</sql>
	
	
	
	<!-- ================================列表条件查询======================================= -->
	<sql id="SaleOutbound.findPage.for.salesDetialSum.where">
	    <dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="saleid">
	             t_sale_outbound.saleid = #saleid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fmarketingstyle">
	             t_sale_outbound.fmarketingstyle = #fmarketingstyle#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="ffetchdateBegin">
	             t_sale_outbound.ffetchdate &gt;= #ffetchdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="ffetchdateEnd">
	             t_sale_outbound.ffetchdate &lt;= #ffetchdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="ffetchadd">
	             t_sale_outbound.ffetchadd = #ffetchadd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fconsignee">
	             t_sale_outbound.fconsignee = #fconsignee#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsalestyle">
	             t_sale_outbound.fsalestyle = #fsalestyle#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fexplanation">
	             t_sale_outbound.fexplanation = #fexplanation#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbillno">
	             t_sale_outbound.fbillno = #fbillno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fseltrantype">
	             t_sale_outbound.fseltrantype = #fseltrantype#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fchoosebillno">
	             t_sale_outbound.fchoosebillno = #fchoosebillno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fscstockid">
	             t_sale_outbound.fscstockid = #fscstockid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsendempid">
	             t_sale_outbound.fsendempid = #fsendempid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fcheckerid">
	             t_sale_outbound.fcheckerid = #fcheckerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fdeptid">
	             t_sale_outbound.fdeptid = #fdeptid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fcheckdateBegin">
	              convert(char(10),t_sale_outbound.fcheckdate,120) &gt;= #fcheckdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fcheckdateEnd">
	             convert(char(10),t_sale_outbound.fcheckdate,120) &lt;= #fcheckdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fdateBegin">
	             t_sale_outbound.fdate &gt;= #fdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fdateEnd">
	             t_sale_outbound.fdate &lt;= #fdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fmanagerid">
	             t_sale_outbound.fmanagerid = #fmanagerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fposterid">
	             t_sale_outbound.fposterid = #fposterid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fempid">
	             t_sale_outbound.fempid = #fempid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsmanagerid">
	             t_sale_outbound.fsmanagerid = #fsmanagerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbillerid">
	             t_sale_outbound.fbillerid = #fbillerid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fpoordbillno">
	             t_sale_outbound.fpoordbillno = #fpoordbillno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="ffrom">
	             t_sale_outbound.ffrom = #ffrom#
	       </isNotEmpty>

	       <isNotEmpty prepend="AND" property="fstatus">
	             t_sale_outbound.fstatus = #fstatus#
	       </isNotEmpty>
	        <isNotEmpty prepend="AND" property="isreturn">
	        	t_sale_outbound.isreturn = #isreturn#
	        </isNotEmpty>


	       
	    </dynamic>	
	</sql>
    <sql id="SaleOutbound.findPage.for.salesDetialSum.and">
			<isNotEmpty prepend="AND" property="saleid">
	             t_sale_outbound.saleid = #saleid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fmarketingstyle">
	             t_sale_outbound.fmarketingstyle = #fmarketingstyle#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="ffetchdateBegin">
	             t_sale_outbound.ffetchdate &gt;= #ffetchdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="ffetchdateEnd">
	             t_sale_outbound.ffetchdate &lt;= #ffetchdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="ffetchadd">
	             t_sale_outbound.ffetchadd = #ffetchadd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fconsignee">
	             t_sale_outbound.fconsignee = #fconsignee#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsalestyle">
	             t_sale_outbound.fsalestyle = #fsalestyle#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fexplanation">
	             t_sale_outbound.fexplanation = #fexplanation#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fbillno">
	             t_sale_outbound.fbillno = #fbillno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fseltrantype">
	             t_sale_outbound.fseltrantype = #fseltrantype#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fchoosebillno">
	             t_sale_outbound.fchoosebillno = #fchoosebillno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fscstockid">
	             t_sale_outbound.fscstockid = #fscstockid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsendempid">
	             t_sale_outbound.fsendempid = #fsendempid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fcheckerid">
	             t_sale_outbound.fcheckerid = #fcheckerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fdeptid">
	             t_sale_outbound.fdeptid = #fdeptid#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fcheckdateBegin">
	              convert(char(10),t_sale_outbound.fcheckdate,120) &gt;= #fcheckdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fcheckdateEnd">
	             convert(char(10),t_sale_outbound.fcheckdate,120) &lt;= #fcheckdateEnd#
	       </isNotEmpty>     
	       
			<isNotEmpty prepend="AND" property="fdateBegin">
	             t_sale_outbound.fdate &gt;= #fdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fdateEnd">
	             t_sale_outbound.fdate &lt;= #fdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fmanagerid">
	             t_sale_outbound.fmanagerid = #fmanagerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fposterid">
	             t_sale_outbound.fposterid = #fposterid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fempid">
	             t_sale_outbound.fempid = #fempid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsmanagerid">
	             t_sale_outbound.fsmanagerid = #fsmanagerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fbillerid">
	             t_sale_outbound.fbillerid = #fbillerid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fpoordbillno">
	             t_sale_outbound.fpoordbillno = #fpoordbillno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="ffrom">
	             t_sale_outbound.ffrom = #ffrom#
	       </isNotEmpty>

	         <isNotEmpty prepend="AND" property="fstatus">
	             t_sale_outbound.fstatus = #fstatus#
	       </isNotEmpty>
	        <isNotEmpty prepend="AND" property="isreturn">
	        	t_sale_outbound.isreturn = #isreturn#
	        </isNotEmpty>
	     
	</sql>
	<!-- ======================================================================== -->
	
    <select id="SaleOutbound.Entity" resultMap="RM.SaleOutbound">
    	SELECT 	<include refid="SaleOutbound.columns"/> FROM t_sale_outbound <include refid="SaleOutbound.findPage.where"/>
    </select>
    
    <select id="SaleOutbound.findList" resultMap="RM.SaleOutbound">
    	SELECT 
    		<include refid="SaleOutbound.columns"/> 
    	FROM 
    		t_sale_outbound
		<include refid="SaleOutbound.findPage.where"/>
		<isNotEmpty property="sortColumns">
			ORDER BY $sortColumns$
		</isNotEmpty>
    </select>
    
    <select id="SaleOutbound.findPage.count" resultClass="long">
    <![CDATA[
        select 
        count(*)
        from t_sale_outbound
    ]]>
		<include refid="SaleOutbound.findPage.where"/>    
    </select>
    <!--
    	分页查询已经使用Dialect进行分页,也可以不使用Dialect直接编写分页
    	因为分页查询将传 #offset#,#pageSize#,#lastRows# 三个参数,不同的数据库可以根于此三个参数属性应用不同的分页实现
    -->
    <select id="Sql.SaleOutbound.findPage" resultMap="RM.SaleOutbound">
    	select <include refid="SaleOutbound.columns"/>	    
	        from t_sale_outbound 	   
		<include refid="SaleOutbound.findPage.where"/>		
		<isNotEmpty property="sortColumns">ORDER BY $sortColumns$</isNotEmpty>
		
    </select>
    
	<select id="SaleOutbound.findPage" resultMap="RM.SaleOutbound">
    	select <include refid="SaleOutbound.columns"/>	    
	        from t_sale_outbound where 1=1 
	   <isNotEmpty property="notTop">  and 
       saleid 
	   not in(select $notTop$ 
       saleid 
	   from t_sale_outbound <include refid="SaleOutbound.findPage.where"/>
	   	   <isNotEmpty property="sortColumns"> ORDER BY $sortColumns$	</isNotEmpty>) 
	   	</isNotEmpty>    
	   	<include refid="SaleOutbound.findPage.and"/>
    	<isNotEmpty property="sortColumns">
			ORDER BY $sortColumns$
		</isNotEmpty>
	
		
    </select>
  <!-- =======================================新的列表查询=================================== -->
  
  <select id="SaleOutbound.findPage.AND.SalesDetailSum.count" resultClass="long">
   
        select 
        count(*)
        from t_sale_outbound
          left join t_admin on t_sale_outbound.fbillerid = t_admin.adminId
       	  left join t_admin sh on t_sale_outbound.fcheckerid = sh.adminId
          left join t_admin fh on t_sale_outbound.fsendempid = fh.adminId
          left join t_department on t_sale_outbound.fdeptid = t_department.teamid
          left join t_admin zg on t_sale_outbound.fmanagerid = zg.adminId
          left join t_admin jz on t_sale_outbound.fposterid = jz.adminId
          left join t_admin yw on t_sale_outbound.fempid = yw.adminId
          left join t_admin bg on t_sale_outbound.fsmanagerid = bg.adminId
          left join t_stock on t_sale_outbound.fscstockid = t_stock.fitemid
           left join t_organization on  t_sale_outbound.fconsignee= t_organization.fitemid
          <!--  <isNotEmpty  property="itemcode">
	        left join t_sales_detail_sum on t_sale_outbound.saleid = t_sales_detail_sum.saleid
	        </isNotEmpty>
	        <isNotEmpty property="stockid">
	        left join t_sales_detail_sum saletable1 on t_sale_outbound.saleid = saletable1.saleid
	        </isNotEmpty>
	        <isNotEmpty  property="fsourcecode">
	        left join t_sales_detail_sum saletable2 on t_sale_outbound.saleid = saletable2.saleid
	        </isNotEmpty> -->
  		
  		where 1=1
		<include refid="SaleOutbound.findPage.for.salesDetialSum.and"/> 
		<isNotEmpty prepend="AND" property="itemcode">
	            t_sale_outbound.saleid in ( select saleid from  t_sales_detail_sum where itemcode like ('%$itemcode$%') group by saleid)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="stockid">
	             t_sale_outbound.saleid in ( select saleid from  t_sales_detail_sum where stockid = #stockid# group by saleid )
	       </isNotEmpty>  
	       <isNotEmpty prepend="AND" property="fsourcecode">
	            t_sale_outbound.saleid in ( select saleid from  t_sales_detail_sum where like ('%$fsourcecode$%') group by saleid )
	       </isNotEmpty> 
    </select>
     
	<select id="SaleOutbound.findPage.AND.SalesDetailSum" resultMap="RM.SaleOutbound.find.SalesSum.data">
    	select <include refid="SaleOutbound.columns"/>,t_admin.adminName zdname,sh.adminName shname,fh.adminName fhname,
	    t_department.teamname bmname,zg.adminName zgname,jz.adminName jzname,yw.adminName ywname,bg.adminName bgname,
	    t_stock.fname stockname,t_organization.fname gwName	    
	        from t_sale_outbound 
	           left join t_admin on t_sale_outbound.fbillerid = t_admin.adminId
	       	  left join t_admin sh on t_sale_outbound.fcheckerid = sh.adminId
	          left join t_admin fh on t_sale_outbound.fsendempid = fh.adminId
	          left join t_department on t_sale_outbound.fdeptid = t_department.teamid
	          left join t_admin zg on t_sale_outbound.fmanagerid = zg.adminId
	          left join t_admin jz on t_sale_outbound.fposterid = jz.adminId
	          left join t_admin yw on t_sale_outbound.fempid = yw.adminId
	          left join t_admin bg on t_sale_outbound.fsmanagerid = bg.adminId
	          left join t_stock on t_sale_outbound.fscstockid = t_stock.fitemid
	           left join t_organization on  t_sale_outbound.fconsignee= t_organization.fitemid
	       <!--  <isNotEmpty  property="itemcode">
	        left join t_sales_detail_sum on t_sale_outbound.saleid = t_sales_detail_sum.saleid
	        </isNotEmpty>
	        <isNotEmpty property="stockid">
	        left join t_sales_detail_sum saletable1 on t_sale_outbound.saleid = saletable1.saleid
	        </isNotEmpty>
	        <isNotEmpty  property="fsourcecode">
	        left join t_sales_detail_sum saletable2 on t_sale_outbound.saleid = saletable2.saleid
	        </isNotEmpty> -->
	        where 1=1 
	        
	        <isNotEmpty prepend="AND" property="itemcode">
	         t_sale_outbound.saleid in (select saleid from  t_sales_detail_sum where itemcode like ('%$itemcode$%') group by saleid)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="stockid">
	            t_sale_outbound.saleid in (select saleid from  t_sales_detail_sum where stockid = #stockid# group by saleid)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fsourcecode">
	            t_sale_outbound.saleid in (select saleid from  t_sales_detail_sum where like ('%$fsourcecode$%') group by saleid)
	       </isNotEmpty>
	   <isNotEmpty property="notTop">  and 
       saleid 
	   not in(select $notTop$ 
       saleid 
	   from t_sale_outbound
	    left join t_admin on t_sale_outbound.fbillerid = t_admin.adminId
	       	  left join t_admin sh on t_sale_outbound.fcheckerid = sh.adminId
	          left join t_admin fh on t_sale_outbound.fsendempid = fh.adminId
	          left join t_department on t_sale_outbound.fdeptid = t_department.teamid
	          left join t_admin zg on t_sale_outbound.fmanagerid = zg.adminId
	          left join t_admin jz on t_sale_outbound.fposterid = jz.adminId
	          left join t_admin yw on t_sale_outbound.fempid = yw.adminId
	          left join t_admin bg on t_sale_outbound.fsmanagerid = bg.adminId
	          left join t_stock on t_sale_outbound.fscstockid = t_stock.fitemid
	           left join t_organization on  t_sale_outbound.fconsignee= t_organization.fitemid
	    
	    <include refid="SaleOutbound.findPage.for.salesDetialSum.where"/>
	    
	    <isNotEmpty prepend="AND" property="itemcode">
	         t_sale_outbound.saleid in (select saleid from  t_sales_detail_sum where itemcode like ('%$itemcode$%') group by saleid)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="stockid">
	            t_sale_outbound.saleid in (select saleid from  t_sales_detail_sum where stockid = #stockid# group by saleid)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="fsourcecode">
	            t_sale_outbound.saleid in (select saleid from  t_sales_detail_sum where fsourcecode like ('%$fsourcecode$%') group by saleid)
	       </isNotEmpty>
	       
	   	   <isNotEmpty property="sortColumns"> ORDER BY $sortColumns$	</isNotEmpty>) 
	   	</isNotEmpty>    
	   	<include refid="SaleOutbound.findPage.for.salesDetialSum.and"/>
    	<isNotEmpty property="sortColumns">
			ORDER BY $sortColumns$
		</isNotEmpty>		
    </select>
    
    
     <select id="SalesDetailSum.find.mingxi.data.select" resultMap="RM.SalesDetailSum.in.saleOutBound.top3">
    	select top 3 t_sales_detail_sum.sdetailid ,t_sales_detail_sum.saleid ,t_sales_detail_sum.itemcode ,
        	t_sales_detail_sum.itemname ,t_sales_detail_sum.itemmode ,t_sales_detail_sum.baseunitid ,t_sales_detail_sum.fbatchno ,
        	t_sales_detail_sum.fqty ,t_sales_detail_sum.unitid ,t_sales_detail_sum.payfqty ,t_sales_detail_sum.notes ,
        	t_sales_detail_sum.stockid ,t_sales_detail_sum.saleprice ,t_sales_detail_sum.saleamount ,t_sales_detail_sum.fsourcecode ,
        	t_sales_detail_sum.fdate,t_sales_detail_sum.dbno ,t_stock.fname stockname,t_measureunit.fname unitName,
        	  t_base_item.fissnmanager fissnmanager , t_base_item.isbatch isbatch 
	        from t_sales_detail_sum 
	        	
		 	 left join t_stock on t_sales_detail_sum.stockid = t_stock.fitemid
	        left join t_measureunit on t_sales_detail_sum.unitid = t_measureunit.fmeasureunitid
	        left join t_base_item on t_sales_detail_sum.itemcode = t_base_item.itemcode
	        
	        where 1= 1 and t_sales_detail_sum.saleid = #saleid#
	       
		
    </select>
  <!-- ========================================================================== -->
	
    <select id="SaleOutbound.find.entity.saleOut" resultMap="RM.SaleOutbound.check.detail.find">
	    select <include refid="SaleOutbound.columns"/>,t_admin.adminName zdname,sh.adminName shname,fh.adminName fhname,
	    t_department.teamname bmname,zg.adminName zgname,jz.adminName jzname,yw.adminName ywname,bg.adminName bgname,
	    t_stock.fname stockname,t_organization.fname gwName
	        from t_sale_outbound 
	        left join t_admin on t_sale_outbound.fbillerid = t_admin.adminId
	         left join t_admin sh on t_sale_outbound.fcheckerid = sh.adminId
	          left join t_admin fh on t_sale_outbound.fsendempid = fh.adminId
	          left join t_department on t_sale_outbound.fdeptid = t_department.teamid
	          left join t_admin zg on t_sale_outbound.fmanagerid = zg.adminId
	          left join t_admin jz on t_sale_outbound.fposterid = jz.adminId
	          left join t_admin yw on t_sale_outbound.fempid = yw.adminId
	          left join t_admin bg on t_sale_outbound.fsmanagerid = bg.adminId
	          left join t_stock on t_sale_outbound.fscstockid = t_stock.fitemid
	          
	           left join t_organization on  t_sale_outbound.fconsignee= t_organization.fitemid
	       <include refid="SaleOutbound.findPage.where"/>
	    
    </select>
	
</sqlMap>
