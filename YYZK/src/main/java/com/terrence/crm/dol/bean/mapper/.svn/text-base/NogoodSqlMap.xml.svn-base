<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" 
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="Nogood">

        
	<resultMap id="RM.Nogood" class="com.terrence.crm.dol.bean.Nogood">
        <result property="rid" column="rid"/>
        <result property="checkid" column="checkid"/>
        <result property="workno" column="workno"/>
        <result property="itemcode" column="itemcode"/>
        <result property="itemname" column="itemname"/>
        <result property="itemmode" column="itemmode"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="seqno" column="seqno"/>
        <result property="emp" column="emp"/>
        <result property="fqty" column="fqty"/>
        <result property="cstatus" column="cstatus"/>
        <result property="cdate" column="cdate"/>
        <result property="pbdate" column="pbdate"/>
        <result property="pedate" column="pedate"/>
        <result property="createdate" column="createdate"/>
        <result property="closestatus" column="closestatus"/>
        <result property="qc" column="qc"/>
        <result property="qs" column="qs"/>
        <result property="ftype" column="ftype"/>
        <result property="sourceid" column="sourceid"/>
        <result property="replystatus" column="replystatus"/>
        <result property="fsrcno" column="fsrcno"/>
        <result property="designStatus" column="designStatus"/>
        <result property="leaderStatus" column="leaderStatus"/>
        <result property="checkerStatus" column="checkerStatus"/>
        <result property="depStatus" column="depStatus"/>
        <result property="qsAdvice" column="qsAdvice"/>
        <result property="qcdate" column="qcdate"/>
        <result property="qcName" column="qcName"/>
        <result property="qcAdvice" column="qcAdvice"/>
        <result property="repair" column="repair"/>
        <result property="materialnopass" column="materialnopass"/>
        <result property="makenoapass" column="makenoapass"/>
        <result property="concession" column="concession"/>
        <result property="backToFactory" column="backToFactory"/>
        <result property="empName" column="empName"/>
        <result property="qsName" column="qsName"/>
        <result property="tablesum" column="tablesum"/>
        <result property="submitCount" column="submitCount"/>
        <result property="goodCount" column="goodCount"/>
        <result property="preSeqCount" column="preSeqCount"/>
        <result property="onceGoodCount" column="onceGoodCount"/>
        <result property="submitToCheckCount" column="submitToCheckCount"/>
        <result property="repairGoods" column="repairGoods"/>
    </resultMap>
	<resultMap id="RM.NogoodAll" class="com.terrence.crm.dol.bean.Nogood">
        <result property="rid" column="rid"/>
        <result property="checkid" column="checkid"/>
        <result property="workno" column="workno"/>
        <result property="itemcode" column="itemcode"/>
        <result property="itemname" column="itemname"/>
        <result property="itemmode" column="itemmode"/>
        <result property="fbatchno" column="fbatchno"/>
        <result property="seqno" column="seqno"/>
        <result property="emp" column="emp"/>
        <result property="fqty" column="fqty"/>
        <result property="cstatus" column="cstatus"/>
        <result property="cdate" column="cdate"/>
        <result property="pbdate" column="pbdate"/>
        <result property="pedate" column="pedate"/>
        <result property="createdate" column="createdate"/>
        <result property="closestatus" column="closestatus"/>
        <result property="qc" column="qc"/>
        <result property="qs" column="qs"/>
        <result property="ftype" column="ftype"/>
        <result property="sourceid" column="sourceid"/>
        <result property="replystatus" column="replystatus"/>
        <result property="fsrcno" column="fsrcno"/>
        <result property="designStatus" column="designStatus"/>
        <result property="leaderStatus" column="leaderStatus"/>
        <result property="checkerStatus" column="checkerStatus"/>
        <result property="depStatus" column="depStatus"/>
        <result property="qsAdvice" column="qsAdvice"/>
        <result property="qcdate" column="qcdate"/>
        <result property="qcName" column="qcName"/>
        <result property="qcAdvice" column="qcAdvice"/>
        <result property="repair" column="repair"/>
        <result property="materialnopass" column="materialnopass"/>
        <result property="makenoapass" column="makenoapass"/>
        <result property="concession" column="concession"/>
        <result property="backToFactory" column="backToFactory"/>
        <result property="empName" column="empName"/>
        <result property="qsName" column="qsName"/>
        <result property="tablesum" column="tablesum"/>
        <result property="submitCount" column="submitCount"/>
        <result property="goodCount" column="goodCount"/>
        <result property="preSeqCount" column="preSeqCount"/>
        <result property="onceGoodCount" column="onceGoodCount"/>
        <result property="submitToCheckCount" column="submitToCheckCount"/>
        <result property="repairGoods" column="repairGoods"/>
        <result property="nogoodNotes" column="rid" select="Nogood.find.nogoodNotes"/>
    </resultMap>
	<resultMap id="RM.NogoodNote_Nogood" class="com.terrence.crm.dol.bean.NogoodNote">
        <result property="noteid" column="noteid"/>
        <result property="rid" column="rid"/>
        <result property="checkid" column="checkid"/>
        <result property="fdescription" column="fdescription"/>
        <result property="fqty" column="fqty"/>
        <result property="pmode" column="pmode"/>
        <result property="severity" column="severity"/>
        <result property="cause" column="cause"/>
        <result property="cemp" column="cemp"/>
        <result property="fdept" column="fdept"/>
        <result property="fdeptnames" column="fdeptnames"/>
        <result property="demp" column="demp"/>
        <result property="dempName" column="dempName"/>
        <result property="pemp" column="pemp"/>
        <result property="pempName" column="pempName"/>
        <result property="havenot" column="havenot"/>
        <result property="repair" column="repair"/>
        <result property="materialnopass" column="materialnopass"/>
        <result property="makenoapass" column="makenoapass"/>
        <result property="concession" column="concession"/>
        <result property="leaderidea" column="leaderidea"/>
        <result property="designeridea" column="designeridea"/>
        <result property="replystatus" column="replystatus"/>
        <result property="processstatus" column="processstatus"/>
        <result property="processdate" column="processdate"/>
        <result property="heardate" column="heardate"/>
        <result property="isdesigner" column="isdesigner"/>
        <result property="isleader" column="isleader"/>
        <result property="handleStatus" column="handleStatus"/>
        <result property="checkerconfirm" column="checkerconfirm"/>
    </resultMap>  

	<!-- 用于select查询公用抽取的列 -->
	<sql id="Nogood.columns">
	    <![CDATA[
        	t_nogood.rid ,
        	t_nogood.checkid ,
        	t_nogood.workno ,
        	t_nogood.itemcode ,
        	t_nogood.itemname ,
        	t_nogood.itemmode ,
        	t_nogood.fbatchno ,
        	t_nogood.seqno ,
        	t_nogood.emp ,
        	t_nogood.fqty ,
        	t_nogood.cstatus ,
        	t_nogood.cdate ,
        	t_nogood.pbdate ,
        	t_nogood.pedate ,
        	t_nogood.createdate ,
        	t_nogood.closestatus ,
        	t_nogood.qc ,
        	t_nogood.qs ,
        	t_nogood.ftype ,
        	t_nogood.sourceid ,
        	t_nogood.replystatus ,
        	t_nogood.fsrcno ,
        	t_nogood.designStatus ,
        	t_nogood.leaderStatus ,
        	t_nogood.checkerStatus ,
        	t_nogood.depStatus ,
        	t_nogood.qsAdvice,
        	t_nogood.qcdate ,
        	t_nogood.qcAdvice ,
        	t_nogood.repair ,
        	t_nogood.materialnopass ,
        	t_nogood.makenoapass ,
        	t_nogood.concession ,
        	t_nogood.backToFactory ,
        	t_nogood.tablesum,
        	t_nogood.submitCount,
			t_nogood.goodCount,
			t_nogood.preSeqCount,
			t_nogood.onceGoodCount,
			t_nogood.submitToCheckCount,
			t_nogood.repairGoods
	    ]]>
	</sql>
	
   <insert id="Nogood.insert" >
        INSERT INTO
        t_nogood (
        	checkid ,
        	workno ,
        	itemcode ,
        	itemname ,
        	itemmode ,
        	fbatchno ,
        	seqno ,
        	emp ,
        	fqty ,
        	cstatus ,
        	cdate ,
        	pbdate ,
        	pedate ,
        	createdate ,
        	closestatus ,
        	qc ,
        	qs ,
        	ftype ,
        	sourceid ,
        	replystatus ,
        	fsrcno ,
        	designStatus ,
        	leaderStatus ,
        	checkerStatus ,
        	depStatus,
        	qsAdvice ,
        	qcdate,
        	qcAdvice,
        	repair ,
        	materialnopass ,
        	makenoapass ,
        	concession ,
        	backToFactory,
        	tablesum
        	<isNotEmpty prepend="," property="submitCount">
	        	submitCount
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="onceGoodCount">
	        	onceGoodCount
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="submitToCheckCount">
	        	submitToCheckCount
	        </isNotEmpty>
        ) VALUES (
        	#checkid# ,
        	#workno# ,
        	#itemcode# ,
        	#itemname# ,
        	#itemmode# ,
        	#fbatchno# ,
        	#seqno# ,
        	#emp# ,
        	#fqty# ,
        	#cstatus# ,
        	#cdate# ,
        	#pbdate# ,
        	#pedate# ,
        	#createdate# ,
        	#closestatus# ,
        	#qc# ,
        	#qs# ,
        	#ftype# ,
        	#sourceid# ,
        	#replystatus# ,
        	#fsrcno# ,
        	#designStatus# ,
        	#leaderStatus# ,
        	#checkerStatus# ,
        	#depStatus# ,
        	#qsAdvice# ,
        	#qcdate#,
        	#qcAdvice#,
        	#repair# ,
        	#materialnopass# ,
        	#makenoapass# ,
        	#concession# ,
        	#backToFactory# ,
        	#tablesum#
        	<isNotEmpty prepend="," property="submitCount">
	        	#submitCount#
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="onceGoodCount">
	        	#onceGoodCount#
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="submitToCheckCount">
	        	#submitToCheckCount#
	        </isNotEmpty>
        )
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="rid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>
 
    
    <insert id="Nogood.newData.insert" >
    
        INSERT INTO
        t_nogood (
	        	itemcode
        	<isNotEmpty prepend="," property="checkid">
	        	checkid 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="workno">
	        	workno 
	        </isNotEmpty>
	      
	        <isNotEmpty prepend="," property="itemname">
	        	itemname
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="itemmode">
	        	itemmode
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	fbatchno
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="seqno">
	        	seqno 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="emp">
	        	emp
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	fqty
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="cstatus">
	        	cstatus
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="cdate">
	        	cdate 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="pbdate">
	        	pbdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="pedate">
	        	pedate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	createdate
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="closestatus">
	        	closestatus
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="qc">
	        	qc
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="qs">
	        	qs
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ftype">
	        	ftype
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="sourceid">
	        	sourceid 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="replystatus">
	        	replystatus
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcno">
	        	fsrcno
	        </isNotEmpty>
	        
	         <isNotEmpty prepend="," property="tablesum">
	        	tablesum
	        </isNotEmpty>
        ) VALUES (
        	
        	
	        	#itemcode# 
	      
        	<isNotEmpty prepend="," property="checkid">
	        	#checkid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="workno">
	        	#workno# 
	        </isNotEmpty>
	        
	        <isNotEmpty prepend="," property="itemname">
	        	#itemname# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="itemmode">
	        	#itemmode# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	#fbatchno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="seqno">
	        	#seqno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="emp">
	        	#emp# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	#fqty# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="cstatus">
	        	#cstatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="cdate">
	        	#cdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="pbdate">
	        	#pbdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="pedate">
	        	#pedate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	#createdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="closestatus">
	        	#closestatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="qc">
	        	#qc# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="qs">
	        	#qs# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ftype">
	        	#ftype# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="sourceid">
	        	#sourceid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="replystatus">
	        	#replystatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcno">
	        	#fsrcno# 
	        </isNotEmpty>
	          <isNotEmpty prepend="," property="tablesum">
	        	#tablesum#
	        </isNotEmpty>
        )
   
    <!--
    mysql:		type="post" SELECT  select last_insert_id()
    sqlserver:	type="post" SELECT  @@identity  AS  ID
    oracle:		type="pre" 	SELECT  sequenceName.nextval AS ID FROM DUAL
    DB2:		type="pre"	values nextval for sequenceName
    -->
        <selectKey resultClass="java.lang.Long" type="post" keyProperty="rid" >
            SELECT  @@identity  AS  ID
        </selectKey>
    </insert>
    
    
	<update id="Nogood.update" parameterClass="com.terrence.crm.dol.bean.Nogood">         
        UPDATE t_nogood 
        <dynamic prepend="SET">
        		repair = #repair# ,
	        	materialnopass = #materialnopass# ,
	        	makenoapass = #makenoapass# ,
	        	concession = #concession# ,
	        	backToFactory = #backToFactory# ,
	        	repairGoods=#repairGoods#,
	        <isNotEmpty prepend="," property="checkid">
	        	checkid = #checkid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="workno">
	        	workno = #workno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="itemcode">
	        	itemcode = #itemcode# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="itemname">
	        	itemname = #itemname# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="itemmode">
	        	itemmode = #itemmode# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fbatchno">
	        	fbatchno = #fbatchno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="seqno">
	        	seqno = #seqno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="emp">
	        	emp = #emp# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fqty">
	        	fqty = #fqty# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="cstatus">
	        	cstatus = #cstatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="cdate">
	        	cdate = #cdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="pbdate">
	        	pbdate = #pbdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="pedate">
	        	pedate = #pedate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="createdate">
	        	createdate = #createdate# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="closestatus">
	        	closestatus = #closestatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="qc">
	        	qc = #qc# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="qs">
	        	qs = #qs# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="ftype">
	        	ftype = #ftype# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="sourceid">
	        	sourceid = #sourceid# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="replystatus">
	        	replystatus = #replystatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="fsrcno">
	        	fsrcno = #fsrcno# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="designStatus">
	        	designStatus = #designStatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="leaderStatus">
	        	leaderStatus = #leaderStatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="checkerStatus">
	        	checkerStatus = #checkerStatus# 
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="depStatus">
	        	depStatus = #depStatus# 
	        </isNotEmpty>
	        <isNotNull prepend="," property="qsAdvice">
	        	qsAdvice = #qsAdvice# 
	        </isNotNull>
	        <isNotEmpty prepend="," property="qcdate">
	        	qcdate = #qcdate# 
	        </isNotEmpty>
	        <isNotNull prepend="," property="qcAdvice">
	        	qcAdvice = #qcAdvice# 
	        </isNotNull>
	        <isNotEmpty prepend="," property="tablesum">
	        	tablesum=#tablesum#
	        </isNotEmpty>
			<isNotEmpty prepend="," property="submitCount">
	        	submitCount=#submitCount#
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="goodCount">
	        	goodCount=#goodCount#
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="preSeqCount">
	        	preSeqCount=#preSeqCount#
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="onceGoodCount">
	        	onceGoodCount=#onceGoodCount#
	        </isNotEmpty>
	        <isNotEmpty prepend="," property="submitToCheckCount">
	        	submitToCheckCount=#submitToCheckCount#
	        </isNotEmpty>
	    </dynamic>
        WHERE 
	        rid = #rid# 
    </update>
    
	<delete id="Nogood.delete" parameterClass="java.lang.Long">
    <![CDATA[
        delete from t_nogood where
       rid = #rid# 
    ]]>
    </delete>
    
    <delete id="Nogood.deleteMultiple">
    <![CDATA[
        DELETE FROM 
        	t_nogood 
        WHERE
       rid in ($rid$) 
    ]]>
    </delete>
    
    <select id="Nogood.getById" resultMap="RM.Nogood">
	    select <include refid="Nogood.columns"/>,ta1.adminname qcName ,ta2.adminname empName ,ta3.adminname qsName 
	    
	        from t_nogood 
	        left join t_admin ta1 on t_nogood.qc=ta1.adminId 
	        left join t_admin ta2 on t_nogood.emp = ta2.adminId 
	        left join t_admin ta3 on t_nogood.qs = ta3.adminId 
	        where 
		        rid = #rid# 
	    
    </select>
    
	<select id="Nogood.getByProperty" resultMap="RM.Nogood">
		select <include refid="Nogood.columns"/> ,ta1.adminname qcName ,ta2.adminname empName ,ta3.adminname qsName 
	    
	        from t_nogood 
	        left join t_admin ta1 on t_nogood.qc=ta1.adminId 
	        left join t_admin ta2 on t_nogood.emp = ta2.adminId 
	        left join t_admin ta3 on t_nogood.qs = ta3.adminId 
	        where $propertyName$=#propertyValue#
	</select>
	
	<sql id="Nogood.findPage.where">
	    <dynamic prepend="WHERE">
			<isNotEmpty prepend="AND" property="rid">
	             t_nogood.rid = #rid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="checkid">
	             t_nogood.checkid = #checkid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="workno">
	             t_nogood.workno = #workno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="itemcode">
	             t_nogood.itemcode = #itemcode#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="itemname">
	             t_nogood.itemname like ('%$itemname$%')
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="itemmode">
	             t_nogood.itemmode = #itemmode#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fbatchno">
	             t_nogood.fbatchno = #fbatchno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="seqno">
	             t_nogood.seqno = #seqno#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="emp">
	             t_nogood.emp = #emp#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fqty">
	             t_nogood.fqty = #fqty#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="cstatus">
	             t_nogood.cstatus = #cstatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="cdateBegin">
	             t_nogood.cdate &gt;= #cdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="cdateEnd">
	             t_nogood.cdate &lt;= #cdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="pbdateBegin">
	             t_nogood.pbdate &gt;= #pbdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="pbdateEnd">
	             t_nogood.pbdate &lt;= #pbdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="pedateBegin">
	             t_nogood.pedate &gt;= #pedateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="pedateEnd">
	             t_nogood.pedate &lt;= #pedateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="createdateBegin">
	             t_nogood.createdate &gt;= #createdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="createdateEnd">
	             t_nogood.createdate &lt;= #createdateEnd#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="closestatus">
	             t_nogood.closestatus = #closestatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="qc">
	             t_nogood.qc = #qc#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="qs">
	             t_nogood.qs = #qs#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="ftype">
	             t_nogood.ftype = #ftype#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="sourceid">
	             t_nogood.sourceid = #sourceid#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="replystatus">
	             t_nogood.replystatus = #replystatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="fsrcno">
	             t_nogood.fsrcno = #fsrcno#
	       </isNotEmpty>
	       
	       <isNotEmpty prepend="AND" property="designStatus">
	             t_nogood.designStatus = #designStatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="leaderStatus">
	             t_nogood.leaderStatus = #leaderStatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="checkerStatus">
	             t_nogood.checkerStatus = #checkerStatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="depStatus">
	             t_nogood.depStatus = #depStatus#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="isLeader">
	             t_nogood.rid in (select rid from t_nogood_note where t_nogood_note.isLeader=#isLeader#)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="isDesigner">
	             t_nogood.rid in (select rid from t_nogood_note where t_nogood_note.isdesigner=#isDesigner#)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="handler">
	             t_nogood.rid in (select rid from t_nogood_note where t_nogood_note.pemp=#handler#)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="tablesum">
	        	t_nogood.tablesum=#tablesum#
	        </isNotEmpty>
	    </dynamic>	
	</sql>
	 
    <sql id="Nogood.findPage.and">
			<isNotEmpty prepend="AND" property="rid">
	             t_nogood.rid = #rid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="checkid">
	             t_nogood.checkid = #checkid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="workno">
	             t_nogood.workno = #workno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="itemcode">
	             t_nogood.itemcode = #itemcode#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="itemname">
	             t_nogood.itemname like ('%$itemname$%')
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="itemmode">
	             t_nogood.itemmode = #itemmode#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fbatchno">
	             t_nogood.fbatchno = #fbatchno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="seqno">
	             t_nogood.seqno = #seqno#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="emp">
	             t_nogood.emp = #emp#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fqty">
	             t_nogood.fqty = #fqty#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="cstatus">
	             t_nogood.cstatus = #cstatus#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="cdateBegin">
	             t_nogood.cdate &gt;= #cdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="cdateEnd">
	             t_nogood.cdate &lt;= #cdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="pbdateBegin">
	             t_nogood.pbdate &gt;= #pbdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="pbdateEnd">
	             t_nogood.pbdate &lt;= #pbdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="pedateBegin">
	             t_nogood.pedate &gt;= #pedateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="pedateEnd">
	             t_nogood.pedate &lt;= #pedateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="createdateBegin">
	             t_nogood.createdate &gt;= #createdateBegin#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="createdateEnd">
	             t_nogood.createdate &lt;= #createdateEnd#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="closestatus">
	             t_nogood.closestatus = #closestatus#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="qc">
	             t_nogood.qc = #qc#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="qs">
	             t_nogood.qs = #qs#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="ftype">
	             t_nogood.ftype = #ftype#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="sourceid">
	             t_nogood.sourceid = #sourceid#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="replystatus">
	             t_nogood.replystatus = #replystatus#
	       </isNotEmpty>
			<isNotEmpty prepend="AND" property="fsrcno">
	             t_nogood.fsrcno = #fsrcno#
	       </isNotEmpty>
	       
	       <isNotEmpty prepend="AND" property="designStatus">
	             t_nogood.designStatus = #designStatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="leaderStatus">
	             t_nogood.leaderStatus = #leaderStatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="checkerStatus">
	             t_nogood.checkerStatus = #checkerStatus#
	       </isNotEmpty>
	       
			<isNotEmpty prepend="AND" property="depStatus">
	             t_nogood.depStatus = #depStatus#
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="isLeader">
	             t_nogood.rid in (select rid from t_nogood_note where t_nogood_note.isLeader=#isLeader#)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="isDesigner">
	             t_nogood.rid in (select rid from t_nogood_note where t_nogood_note.isdesigner=#isDesigner#)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="handler">
	             t_nogood.rid in (select rid from t_nogood_note where t_nogood_note.pemp=#handler#)
	       </isNotEmpty>
	       <isNotEmpty prepend="AND" property="tablesum">
	        	t_nogood.tablesum=#tablesum#
	        </isNotEmpty>
	</sql>
	
    <select id="Nogood.Entity" resultMap="RM.Nogood">
    	SELECT 	<include refid="Nogood.columns"/> ,ta1.adminname qcName ,ta2.adminname empName ,ta3.adminname qsName 
	    
	        from t_nogood 
	        left join t_admin ta1 on t_nogood.qc=ta1.adminId 
	        left join t_admin ta2 on t_nogood.emp = ta2.adminId 
	        left join t_admin ta3 on t_nogood.qs = ta3.adminId  
	        <include refid="Nogood.findPage.where"/>
    </select>
    
    <select id="Nogood.findList" resultMap="RM.Nogood">
    	SELECT 
    		<include refid="Nogood.columns"/>,ta1.adminname qcName ,ta2.adminname empName ,ta3.adminname qsName 
	    
	        from t_nogood 
	        left join t_admin ta1 on t_nogood.qc=ta1.adminId 
	        left join t_admin ta2 on t_nogood.emp = ta2.adminId 
	        left join t_admin ta3 on t_nogood.qs = ta3.adminId 
		<include refid="Nogood.findPage.where"/>
		<isNotEmpty property="sortColumns">
			ORDER BY $sortColumns$
		</isNotEmpty>
    </select>
    
    <select id="Nogood.findPage.count" resultClass="long">
    <![CDATA[
        select 
        count(*)
        from t_nogood
    ]]>
		<include refid="Nogood.findPage.where"/>    
    </select>
    <!--
    	分页查询已经使用Dialect进行分页,也可以不使用Dialect直接编写分页
    	因为分页查询将传 #offset#,#pageSize#,#lastRows# 三个参数,不同的数据库可以根于此三个参数属性应用不同的分页实现
    -->
    <select id="Sql.Nogood.findPage" resultMap="RM.Nogood">
    	select <include refid="Nogood.columns"/>,ta1.adminname qcName ,ta2.adminname empName ,ta3.adminname qsName 
	    
	        from t_nogood 
	        left join t_admin ta1 on t_nogood.qc=ta1.adminId 
	        left join t_admin ta2 on t_nogood.emp = ta2.adminId 
	        left join t_admin ta3 on t_nogood.qs = ta3.adminId 
		<include refid="Nogood.findPage.where"/>		
		<isNotEmpty property="sortColumns">ORDER BY $sortColumns$</isNotEmpty>
		
    </select>
    
	<select id="Nogood.findPage" resultMap="RM.NogoodAll">
    	select <include refid="Nogood.columns"/>,ta1.adminname qcName ,ta2.adminname empName ,ta3.adminname qsName 
	    
	        from t_nogood 
	        left join t_admin ta1 on t_nogood.qc=ta1.adminId 
	        left join t_admin ta2 on t_nogood.emp = ta2.adminId 
	        left join t_admin ta3 on t_nogood.qs = ta3.adminId 
	        where 1=1 
	   <isNotEmpty property="notTop">  and 
       rid 
	   not in(select $notTop$ 
       rid 
	   from t_nogood <include refid="Nogood.findPage.where"/>
	   	   <isNotEmpty property="sortColumns"> ORDER BY $sortColumns$	</isNotEmpty>) 
	   	</isNotEmpty>    
	   	<include refid="Nogood.findPage.and"/>
    	<isNotEmpty property="sortColumns">
			ORDER BY $sortColumns$
		</isNotEmpty>
	
		
    </select>
     <select id="Nogood.findAllInfosById" resultMap="RM.NogoodAll">
	    select <include refid="Nogood.columns"/>,ta1.adminname qcName ,ta2.adminname empName ,ta3.adminname qsName 
	    
	        from t_nogood 
	        left join t_admin ta1 on t_nogood.qc=ta1.adminId 
	        left join t_admin ta2 on t_nogood.emp = ta2.adminId 
	        left join t_admin ta3 on t_nogood.qs = ta3.adminId  
	        where 
		        rid = #rid# 
	    
    </select>
	<select id="Nogood.find.nogoodNotes" resultMap="RM.NogoodNote_Nogood">
			select 
				t_nogood_note.noteid ,
	        	t_nogood_note.rid ,
	        	t_nogood_note.checkid ,
	        	t_nogood_note.fdescription ,
	        	t_nogood_note.fqty ,
	        	t_nogood_note.pmode ,
	        	t_nogood_note.severity ,
	        	t_nogood_note.cause ,
	        	t_nogood_note.cemp ,
	        	t_nogood_note.fdept ,
	        	t_nogood_note.fdeptnames ,
	        	t_nogood_note.demp ,
	        	t_nogood_note.pemp ,
	        	t_nogood_note.havenot ,
	        	t_nogood_note.repair ,
	        	t_nogood_note.materialnopass ,
	        	t_nogood_note.makenoapass ,
	        	t_nogood_note.concession ,
	        	t_nogood_note.leaderidea ,
	        	t_nogood_note.designeridea ,
	        	t_nogood_note.replystatus ,
	        	t_nogood_note.processstatus ,
	        	t_nogood_note.processdate ,
	        	t_nogood_note.heardate ,
	        	t_nogood_note.isdesigner ,
	        	t_nogood_note.isleader ,
	        	t_nogood_note.handleStatus ,
	        	t_nogood_note.checkerconfirm,
	        	ta1.adminName dempName,
	        	ta2.adminName pempName
        	from 
        		t_nogood_note 
        	left join t_admin ta1 on t_nogood_note.demp = ta1.adminId 
        	left join t_admin ta2 on t_nogood_note.pemp = ta2.adminId 
        	where rid=#rid#
	</select>
</sqlMap>
